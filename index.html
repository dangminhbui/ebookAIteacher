<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nhập Môn AI: Hành Trang Cho Nhà Giáo Dục Hiện Đại</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --navy-primary: #0A2342;
            --gold-accent: #FBC02D;
            --text-main: #333333;
            --bg-light: #f8f9fa;
            --bg-white: #FFFFFF;
        }
<style>
    /* ...existing styles... */

    /* Styles cho nút chuyển trang */
    .navigation-buttons {
        background: linear-gradient(to top, rgba(255,255,255,0.95) 0%, rgba(255,255,255,0.95) 80%, rgba(255,255,255,0) 100%);
        padding-top: 2rem;
        transition: all 0.3s ease;
    }

    .navigation-buttons button {
        transition: all 0.2s ease;
    }

    .navigation-buttons button:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    @media (max-width: 768px) {
        .navigation-buttons {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 1rem;
            z-index: 40;
        }

        .navigation-buttons button {
            min-width: 100px;
            padding: 0.75rem 1rem;
        }
    }
</style>
        body {
            font-family: 'Inter', sans-serif;
            color: var(--text-main);
            line-height: 1.7;
            background-color: var(--bg-light);
            overflow-x: hidden; 
        }

        .bg-navy-primary { background-color: var(--navy-primary); }
        .text-navy-primary { color: var(--navy-primary); }
        .border-navy-primary { border-color: var(--navy-primary); }
        .bg-gold-accent { background-color: var(--gold-accent); }
        .text-gold-accent { color: var(--gold-accent); }
        .border-gold-accent { border-color: var(--gold-accent); }

        #sidebar {
            scrollbar-width: thin;
            scrollbar-color: var(--gold-accent) var(--navy-primary);
            background-color: var(--navy-primary);
            position: fixed;
            top: 0;
            left: 0;
            height: 100vh;
            z-index: 50; 
            transform: translateX(-100%); 
            width: 300px; 
        }
        @media (min-width: 1024px) { 
            #sidebar {
                width: 320px; 
            }
        }

        #sidebar.open {
            transform: translateX(0);
        }
        @media (min-width: 768px) { 
            #sidebar {
                transform: translateX(0); 
                position:sticky; 
            }
        }

        #sidebar::-webkit-scrollbar { width: 8px; }
        #sidebar::-webkit-scrollbar-track { background: var(--navy-primary); }
        #sidebar::-webkit-scrollbar-thumb {
            background-color: var(--gold-accent);
            border-radius: 10px;
            border: 2px solid var(--navy-primary);
        }
       
        #navigation-menu ul li a {
            display: block;
            padding: 0.85rem 1.25rem;
            margin-bottom: 0.35rem;
            border-radius: 0.5rem;
            transition: background-color 0.2s ease-in-out, color 0.2s ease-in-out, transform 0.1s ease;
            color: #E5E7EB;
            font-weight: 500;
        }
        #navigation-menu ul li a:hover {
            background-color: var(--gold-accent);
            color: var(--navy-primary);
            transform: translateX(3px);
        }
        #navigation-menu ul li a.active {
            background-color: var(--gold-accent);
            color: var(--navy-primary);
            font-weight: 700;
        }
        #navigation-menu ul .chapter-group-title, #navigation-menu ul .author-info-title {
            padding: 0.5rem 1.25rem;
            margin-top: 0.75rem;
            font-size: 0.8rem;
            color: #9CA3AF;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        .author-info-content {
            padding: 0.5rem 1.25rem;
            font-size: 0.875rem;
            color: #D1D5DB; 
        }
        .author-info-content p { margin-bottom: 0.3rem; }
        .author-info-content i { margin-right: 0.5rem; color: var(--gold-accent); }


        #main-content-wrapper {
            transition: margin-left 0.3s ease-in-out;
            width: 100%; 
        }
        
        #sidebar-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 40; 
            display: none; 
        }
        #sidebar-overlay.active {
            display: block;
        }

        #ebook-content-area {
            max-width: 1000px; 
            margin-left: auto;
            margin-right: auto;
            padding-left: 1.5rem; 
            padding-right: 1.5rem;
        }
        
        .main-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-bottom: 1rem;
            margin-bottom: 1.5rem;
            border-bottom: 1px solid #e5e7eb; /* Tailwind gray-200 */
        }
        .main-header-title-area {
            flex-grow: 1;
        }
        #header-logo-container img {
            height: 48px; /* md:h-12 */
            width: auto;
        }
        @media (min-width: 768px) {
            #header-logo-container img {
                height: 56px; /* md:h-14 */
            }
        }


        #ebook-content-area h1, #ebook-content-area h2, #ebook-content-area h3, #ebook-content-area h4 {
            color: var(--navy-primary);
            margin-top: 1.75em;
            margin-bottom: 0.75em;
            font-weight: 700;
            line-height: 1.3;
        }
        /* Removed ebook-main-title class as title is now in header */
        #ebook-content-area h1 { font-size: 2.25em; border-bottom: 2px solid var(--gold-accent); padding-bottom: 0.3em;}
        #ebook-content-area h2 { font-size: 1.85em; }
        #ebook-content-area h3 { font-size: 1.6em; }
        #ebook-content-area h4 { font-size: 1.35em; }
        #ebook-content-area p { margin-bottom: 1.2em; }
        #ebook-content-area ul, #ebook-content-area ol { margin-left: 1.75em; margin-bottom: 1.2em; list-style-position: outside; }
        #ebook-content-area ul { list-style-type: disc; }
        #ebook-content-area ol { list-style-type: decimal; }
        #ebook-content-area blockquote {
            border-left: 5px solid var(--gold-accent);
            padding-left: 1.5em;
            margin-left: 0;
            margin-top: 1.5em;
            margin-bottom: 1.5em;
            font-style: italic;
            color: #4B5563;
            background-color: #f9fafb;
            padding-top: 0.75em;
            padding-bottom: 0.75em;
            border-radius: 0.375rem;
        }
        #ebook-content-area strong, #ebook-content-area b { font-weight: 700; color: var(--navy-primary); }
        #ebook-content-area .image-container {
            margin-top: 1.5rem;
            margin-bottom: 1.5rem;
            text-align: center;
        }
        #ebook-content-area .image-container img {
            max-width: 100%;
            height: auto;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -1px rgba(0,0,0,0.06);
        }
        #ebook-content-area .image-caption {
            font-size: 0.875rem;
            color: #6B7280;
            margin-top: 0.5rem;
            font-style: italic;
        }
        #ebook-content-area .video-container {
            margin: 1.5rem 0;
            position: relative;
            padding-bottom: 56.25%;
            height: 0;
            overflow: hidden;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -1px rgba(0,0,0,0.06);
        }
        #ebook-content-area .video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }


        .quiz-question {
            background-color: #f9fafb;
            padding: 1.5rem;
            border-radius: 0.75rem;
            margin-bottom: 2rem;
            border: 1px solid #e5e7eb;
            box-shadow: 0 1px 3px 0 rgba(0,0,0,0.07), 0 1px 2px 0 rgba(0,0,0,0.03);
        }
        .quiz-question p { margin-bottom: 1rem; font-weight: 600; }
        .quiz-options label {
            display: flex;
            align-items: center;
            padding: 1rem;
            margin-bottom: 0.75rem;
            background-color: var(--bg-white);
            border: 2px solid #d1d5db;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: border-color 0.2s, background-color 0.2s;
        }
        .quiz-options label:hover {
            border-color: var(--gold-accent);
            background-color: #fefce8;
        }
        .quiz-options input[type="radio"] {
            margin-right: 0.75rem;
            accent-color: var(--navy-primary);
            width: 1.15em;
            height: 1.15em;
        }
        .quiz-feedback {
            padding: 1rem;
            margin-top: 1rem;
            border-radius: 0.5rem;
            font-size: 0.95rem;
        }
        .quiz-feedback.correct {
            background-color: #ECFDF5;
            color: #065F46;
            border: 1px solid #A7F3D0;
        }
        .quiz-feedback.incorrect {
            background-color: #FEF2F2;
            color: #991B1B;
            border: 1px solid #FECACA;
        }
        .quiz-explanation {
            font-size: 0.875rem;
            color: #4B5563;
            margin-top: 0.5rem;
        }
        .submit-quiz-btn {
            background-color: var(--navy-primary);
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 600;
            transition: background-color 0.2s;
        }
        .submit-quiz-btn:hover {
            background-color: #071a30;
        }
        .interactive-box {
            background-color: #EFF6FF;
            border: 1px solid #BFDBFE;
            padding: 1.5rem;
            margin-top: 1.5rem;
            margin-bottom: 1.5rem;
            border-radius: 0.5rem;
        }
        .interactive-box h4 { margin-top: 0; color: #1E40AF; }


        .highlighted-text {
            background-color: rgba(251, 192, 45, 0.5);
            cursor: pointer;
            padding: 0.1em 0;
            border-radius: 0.125rem;
        }
        .note-indicator {
            display: inline-block;
            width: 14px;
            height: 14px;
            background-color: var(--gold-accent);
            border-radius: 50%;
            margin-left: 5px;
            cursor: pointer;
            vertical-align: super;
            font-size: 9px;
            text-align: center;
            line-height: 14px;
            color: var(--navy-primary);
            font-weight: bold;
            box-shadow: 0 0 3px rgba(0,0,0,0.2);
        }
        .note-indicator:hover {
            transform: scale(1.1);
        }
        .glossary-term {
            color: var(--navy-primary);
            font-weight: 600;
            text-decoration: underline dotted var(--gold-accent);
            text-decoration-thickness: 2px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .glossary-term:hover {
            background-color: rgba(251, 192, 45, 0.15);
        }

        .modal-content-scrollable::-webkit-scrollbar {
            width: 6px;
        }
        .modal-content-scrollable::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        .modal-content-scrollable::-webkit-scrollbar-thumb {
            background: #ccc;
            border-radius: 10px;
        }
        .modal-content-scrollable::-webkit-scrollbar-thumb:hover {
            background: #aaa;
        }

        #ebook-content-area table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 1.5em;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        #ebook-content-area th, #ebook-content-area td {
            border: 1px solid #e2e8f0;
            padding: 0.75rem 1rem;
            text-align: left;
        }
        #ebook-content-area th {
            background-color: var(--navy-primary);
            color: white;
            font-weight: 600;
        }
        #ebook-content-area tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        #ebook-content-area tr:hover {
            background-color: #eff6ff;
        }

        .action-button {
            background-color: var(--gold-accent);
            color: var(--navy-primary);
            padding: 0.6rem 1.2rem;
            border-radius: 0.375rem;
            font-weight: 600;
            transition: background-color 0.2s, transform 0.1s;
            border: none;
            cursor: pointer;
        }
        .action-button:hover {
            background-color: #eab308;
            transform: translateY(-1px);
        }
        .action-button i {
            margin-right: 0.5rem;
        }

        #search-input {
            border: 2px solid var(--gold-accent);
            transition: box-shadow 0.2s;
        }
        #search-input:focus {
            box-shadow: 0 0 0 3px rgba(251, 192, 45, 0.4);
            outline: none;
        }
        
        @media (min-width: 768px) {
            #main-content-wrapper {
                margin-left: 300px; 
            }
        }
        @media (min-width: 1024px) { 
             #main-content-wrapper {
                margin-left: 320px; 
            }
        }
        mark.search-highlight {
            background-color: #FDE047; 
            color: #713F12; 
            padding: 0.1em 0.2em;
            border-radius: 0.2em;
        }


    </style>
</head>
<body class="font-inter flex min-h-screen relative">

    <!-- Sidebar -->
    <aside id="sidebar" class="text-white p-6 overflow-y-auto shadow-2xl transition-transform duration-300 ease-in-out">
        <div class="mb-8 text-center">
            <!-- Logo removed from here -->
            <h1 class="text-lg md:text-xl font-bold text-gold-accent mt-8">Nhập Môn AI</h1>
            <p class="text-xs md:text-sm">Hành Trang Cho Nhà Giáo Dục Hiện Đại</p>
        </div>
        <div class="my-4">
            <input type="text" id="search-input" placeholder="Tìm kiếm trong ebook..." class="w-full px-3 py-2 rounded-md text-gray-800 focus:ring-2 focus:ring-gold-accent">
        </div>
        <nav id="navigation-menu">
            <!-- Chapters will be populated by JS -->
        </nav>
        <div id="author-info-sidebar" class="mt-8">
            <!-- Author info will be populated by JS -->
        </div>
    </aside>
    
    <div id="sidebar-overlay"></div>

    <div id="main-content-wrapper">
        <main id="main-content" class="p-6 md:p-8 pt-2 md:pt-6 overflow-y-auto bg-white rounded-tl-lg shadow-inner min-h-screen">
            <!-- Main Header with Logo -->
            <header class="main-header">
                <div class="main-header-title-area">
                    <button id="mobile-menu-toggle" class="md:hidden text-navy-primary text-2xl p-2 mr-2">
                        <i class="fas fa-bars"></i>
                    </button>
                    <h1 id="main-ebook-title-desktop" class="hidden md:inline-block text-2xl lg:text-3xl font-bold text-navy-primary align-middle">
                        Nhập Môn AI: Hành Trang Cho Nhà Giáo Dục Hiện Đại
                    </h1>
                     <h2 id="mobile-chapter-title" class="md:hidden text-xl font-bold text-navy-primary inline-block align-middle">Nội dung</h2>
                </div>
                <div id="header-logo-container">
                    <img src="https://i.postimg.cc/4d0PH133/LOGO-01.png" alt="Logo Pademy" class="h-10 sm:h-12 md:h-14 w-auto">
                </div>
            </header>
            
            <div id="ebook-content-area" class="prose-lg">
                 <p class="text-center text-gray-500 text-lg py-10">Chọn một chương từ menu bên trái để bắt đầu đọc, hoặc tìm kiếm nội dung bạn quan tâm.</p>
            </div>
        </main>
    </div>

    <button id="ask-gemini-btn" title="Hỏi AI Gemini" class="fixed bottom-6 right-6 md:bottom-8 md:right-8 bg-gold-accent text-navy-primary p-4 rounded-full shadow-xl hover:bg-yellow-400 transition-all duration-200 ease-in-out transform hover:scale-110 z-[60]">
        <i class="fas fa-robot fa-lg"></i> <span class="ml-2 hidden md:inline font-semibold">Hỏi Gemini</span>
    </button>

    <div id="gemini-modal" class="fixed inset-0 bg-black bg-opacity-60 hidden items-center justify-center z-[100] p-4">
        <div class="bg-white p-6 md:p-8 rounded-xl shadow-2xl w-full md:w-3/5 lg:w-1/2 max-h-[90vh] flex flex-col modal-content-scrollable">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-semibold text-navy-primary">Hỏi AI Gemini</h3>
                <button id="close-gemini-modal" class="text-gray-500 hover:text-gray-800 text-3xl">×</button>
            </div>
            <textarea id="gemini-prompt-input" class="w-full p-3 border-2 border-gray-300 rounded-lg mb-4 h-36 resize-y focus:border-gold-accent focus:ring-1 focus:ring-gold-accent" placeholder="Nhập câu hỏi hoặc yêu cầu của bạn cho Gemini..."></textarea>
            <button id="submit-gemini-prompt" class="w-full bg-navy-primary text-white py-3 px-4 rounded-lg hover:bg-opacity-90 transition-colors font-semibold flex items-center justify-center">
                Gửi <i class="fas fa-paper-plane ml-2"></i>
            </button>
            <div id="gemini-loading-indicator" class="hidden mt-6 text-center">
                <i class="fas fa-spinner fa-spin fa-3x text-navy-primary"></i>
                <p class="text-navy-primary mt-3 text-lg">Đang xử lý yêu cầu...</p>
            </div>
            <div id="gemini-response-area" class="mt-6 p-4 border border-gray-200 rounded-lg bg-gray-50 min-h-[120px] max-h-[40vh] overflow-y-auto">
                <p class="text-gray-500 italic">Câu trả lời từ Gemini sẽ xuất hiện ở đây...</p>
            </div>
        </div>
    </div>

    <div id="notes-modal" class="fixed inset-0 bg-black bg-opacity-60 hidden items-center justify-center z-[100] p-4">
        <div class="bg-white p-6 rounded-xl shadow-2xl w-full md:w-2/5 lg:w-1/3">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-semibold text-navy-primary">Thêm Ghi Chú</h3>
                <button id="close-notes-modal" class="text-gray-500 hover:text-gray-800 text-3xl">×</button>
            </div>
            <textarea id="note-input" class="w-full p-3 border-2 border-gray-300 rounded-lg mb-4 h-32 resize-y focus:border-gold-accent focus:ring-1 focus:ring-gold-accent" placeholder="Nhập ghi chú của bạn..."></textarea>
            <div class="flex justify-end space-x-3">
                <button id="cancel-note" class="px-5 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 font-medium transition-colors">Hủy</button>
                <button id="save-note" class="px-5 py-2 bg-gold-accent text-navy-primary rounded-lg hover:bg-yellow-400 font-semibold transition-colors">Lưu Ghi Chú</button>
            </div>
        </div>
    </div>

    <div id="glossary-modal" class="fixed inset-0 bg-black bg-opacity-60 hidden items-center justify-center z-[100] p-4">
        <div class="bg-white p-6 rounded-xl shadow-2xl w-full md:w-2/5 lg:w-1/3 max-h-[80vh] overflow-y-auto modal-content-scrollable">
            <div class="flex justify-between items-center mb-4">
                <h3 id="glossary-term-title" class="text-xl font-semibold text-navy-primary">Thuật ngữ</h3>
                <button id="close-glossary-modal" class="text-gray-500 hover:text-gray-800 text-3xl">×</button>
            </div>
            <div id="glossary-term-definition" class="text-gray-700 leading-relaxed"></div>
        </div>
    </div>
    
    <div id="highlight-color-picker" class="absolute bg-white border border-gray-300 shadow-lg rounded-md p-2 z-[110]" style="display: none;">
        <div class="flex space-x-1">
            <button class="w-6 h-6 rounded-full bg-yellow-300 hover:ring-2 ring-offset-1 ring-yellow-400" data-color="rgba(253, 224, 71, 0.5)"></button>
            <button class="w-6 h-6 rounded-full bg-green-300 hover:ring-2 ring-offset-1 ring-green-400" data-color="rgba(110, 231, 183, 0.5)"></button>
            <button class="w-6 h-6 rounded-full bg-blue-300 hover:ring-2 ring-offset-1 ring-blue-400" data-color="rgba(147, 197, 253, 0.5)"></button>
            <button class="w-6 h-6 rounded-full bg-pink-300 hover:ring-2 ring-offset-1 ring-pink-400" data-color="rgba(249, 168, 212, 0.5)"></button>
            <button class="w-6 h-6 rounded-full bg-purple-300 hover:ring-2 ring-offset-1 ring-purple-400" data-color="rgba(196, 181, 253, 0.5)"></button>
            <button id="remove-highlight-btn" class="w-6 h-6 rounded-full bg-gray-300 hover:ring-2 ring-offset-1 ring-gray-400 flex items-center justify-center text-red-600" title="Xóa highlight">
                <i class="fas fa-times"></i>
            </button>
        </div>
    </div>


    <script>
        const ebookData = {
            meta: {
                title: "Nhập Môn AI: Hành Trang Cho Nhà Giáo Dục Hiện Đại",
                author: "Bùi Đăng Minh",
                phone: "0918888691",
                email: "pademy.vn@gmail.com",
                logo: "https://i.postimg.cc/4d0PH133/LOGO-01.png",
                colors: { primary: "#0A2342", accent: "#FBC02D", background: "#f8f9fa", text: "#333333" }
            },
            chapters: [
                {
                    id: "loiMoDau",
                    title: "Lời Mở Đầu",
                    group: "Giới thiệu",
                    objectives: [],
                    contentHTML: `
                        <p>Chào mừng quý thầy cô và các bạn đồng nghiệp đến với ebook "Nhập Môn AI: Hành Trang Cho Nhà Giáo Dục Hiện Đại".</p>
                        <p>Trong kỷ nguyên số, Trí tuệ Nhân tạo (AI) không còn là một khái niệm khoa học viễn tưởng mà đã trở thành một phần không thể thiếu trong cuộc sống, len lỏi vào mọi ngành nghề và lĩnh vực. Giáo dục, với vai trò kiến tạo tương lai, cũng không nằm ngoài dòng chảy mạnh mẽ đó.</p>
                        
                        <h3 class="text-xl font-semibold text-navy-primary mt-6 mb-3">Về tác giả:</h3>
                        <p>Ebook này được biên soạn bởi <strong>Bùi Đăng Minh</strong>.</p>
                        <ul class="list-none pl-0 mb-4 space-y-1 text-sm">
                            <li><i class="fas fa-phone text-gold-accent"></i> Điện thoại: 0918888691</li>
                            <li><i class="fas fa-envelope text-gold-accent"></i> Email: pademy.vn@gmail.com</li>
                        </ul>

                        <h3 class="text-xl font-semibold text-navy-primary mt-6 mb-3">Mục đích của ebook:</h3>
                        <p>Ebook này được biên soạn nhằm mục đích cung cấp những kiến thức nền tảng và ứng dụng thực tiễn nhất của Trí tuệ Nhân tạo (AI) cho các nhà giáo dục. Chúng tôi mong muốn giúp thầy cô tự tin hơn trong việc tìm hiểu, tiếp cận và từng bước ứng dụng AI vào công việc giảng dạy, quản lý lớp học và phát triển chuyên môn, từ đó nâng cao chất lượng giáo dục và khơi gợi tiềm năng của học sinh trong kỷ nguyên số.</p>
                        
                        <h3 class="text-xl font-semibold text-navy-primary mt-6 mb-3">Ebook này dành cho ai:</h3>
                        <ul class="list-disc pl-6 mb-4 space-y-1">
                            <li>Tất cả các thầy cô giáo ở mọi cấp học.</li>
                            <li>Cán bộ quản lý giáo dục.</li>
                            <li>Bất kỳ ai quan tâm đến việc ứng dụng AI để đổi mới dạy và học.</li>
                            <li>Đặc biệt hữu ích cho những người mới bắt đầu tìm hiểu về AI.</li>
                        </ul>

                        <h3 class="text-xl font-semibold text-navy-primary mt-6 mb-3">Những kiến thức và kỹ năng cốt lõi bạn sẽ nhận được:</h3>
                        <ul class="list-disc pl-6 mb-4 space-y-1">
                            <li>Hiểu rõ khái niệm <span class="glossary-term" data-term="AI">AI</span> là gì, các thuật ngữ liên quan và lịch sử phát triển của AI.</li>
                            <li>Nhận biết vai trò của dữ liệu đối với AI và các loại dữ liệu AI thường sử dụng.</li>
                            <li>Khám phá các ứng dụng thực tiễn của AI trong nhiều khía cạnh của công tác giáo dục.</li>
                            <li>Nắm vững kỹ năng viết "<span class="glossary-term" data-term="Prompt">prompt</span>" (câu lệnh) hiệu quả để giao tiếp và yêu cầu AI thực hiện tác vụ.</li>
                            <li>Làm quen với một số công cụ AI phổ biến, hữu ích cho giáo viên.</li>
                            <li>Nhận diện cơ hội, thách thức và các vấn đề đạo đức khi ứng dụng AI trong giáo dục.</li>
                            <li>Có khả năng tự thực hành một số quy trình ứng dụng AI cơ bản.</li>
                        </ul>

                        <blockquote class="mt-8 mb-8 p-6 bg-yellow-50 border-l-4 border-gold-accent text-yellow-800 italic rounded-r-lg">
                            <p class="font-semibold text-lg">Thông điệp truyền cảm hứng:</p>
                            <p>"Kỷ nguyên AI đã đến, mang theo vô vàn cơ hội để chúng ta đổi mới và nâng tầm giáo dục. Ebook này sẽ là người bạn đồng hành, giúp thầy cô không chỉ hiểu về AI mà còn biết cách biến AI thành trợ thủ đắc lực, cùng kiến tạo tương lai học tập sáng tạo và hiệu quả hơn cho thế hệ học trò."</p>
                        </blockquote>
                        <p>Hãy cùng nhau bắt đầu hành trình khám phá đầy thú vị này!</p>
                    `,
                    summary: []
                },
                { 
                    id: "chuong1",
                    title: "Chương 1: Chào Mừng Đến Với Thế Giới AI!",
                    group: "Nền tảng AI",
                    objectives: [
                        "Giải thích được khái niệm Trí tuệ Nhân tạo (AI) bằng ngôn ngữ đơn giản.",
                        "Nêu được ít nhất 3 ví dụ về ứng dụng AI trong cuộc sống hàng ngày.",
                        "Phân biệt sơ lược được AI, Học Máy (Machine Learning) và Học Sâu (Deep Learning).",
                        "Trình bày được một vài cột mốc quan trọng trong lịch sử phát triển của AI.",
                        "Lý giải được tầm quan trọng của việc tìm hiểu AI đối với nhà giáo dục hiện đại."
                    ],
                    contentHTML: `
                        <h3 class="text-xl font-semibold text-navy-primary mt-0 mb-4">Mục tiêu Học Tập Của Chương:</h3>
                        <ul class="list-disc pl-6 mb-6 bg-blue-50 p-4 rounded-md border border-blue-200">
                            ${
                                [
                                    "Giải thích được khái niệm <span class='glossary-term' data-term='AI'>Trí tuệ Nhân tạo (AI)</span> bằng ngôn ngữ đơn giản.",
                                    "Nêu được ít nhất 3 ví dụ về ứng dụng AI trong cuộc sống hàng ngày.",
                                    "Phân biệt sơ lược được AI, <span class='glossary-term' data-term='Machine Learning'>Học Máy (Machine Learning)</span> và <span class='glossary-term' data-term='Deep Learning'>Học Sâu (Deep Learning)</span>.",
                                    "Trình bày được một vài cột mốc quan trọng trong lịch sử phát triển của AI.",
                                    "Lý giải được tầm quan trọng của việc tìm hiểu AI đối với nhà giáo dục hiện đại."
                                ].map(obj => `<li>${obj}</li>`).join('')
                            }
                        </ul>

                        <h4>1.1. AI Không Còn Xa Lạ</h4>
                        <p>Thầy cô có để ý rằng mỗi khi lướt Facebook, những nội dung hiện ra dường như 'đọc vị' được sở thích của mình? Hay khi tìm kiếm trên Google, kết quả lại vô cùng liên quan? Đó chính là những ví dụ gần gũi về AI đang hiện diện xung quanh chúng ta. Từ trợ lý ảo trên điện thoại (Siri, Google Assistant), gợi ý phim trên Netflix, đến cả những chiếc xe tự lái đang được thử nghiệm, AI đang dần thay đổi cách chúng ta sống, làm việc và học tập.</p>
                        <div class="image-container">
                            <!-- Gợi ý tìm kiếm hình ảnh: "collage ứng dụng AI quen thuộc như icon Netflix Facebook Google Search trợ lý ảo" -->
                            <img src="https://i.postimg.cc/pTj3z03v/ng-d-ng-ai-trong-i-s-ng.png" alt="Collage ứng dụng AI quen thuộc">
                            <p class="image-caption">Minh họa các ứng dụng AI trong đời sống.</p>
                        </div>

                        <h4>1.2. Vậy, AI Là Gì? (Định Nghĩa Đơn Giản Cho Nhà Giáo Dục)</h4>
                        <p>Hiểu một cách đơn giản, <strong class="glossary-term" data-term="AI">Trí tuệ Nhân tạo (Artificial Intelligence - AI)</strong> là lĩnh vực khoa học máy tính tập trung vào việc tạo ra các hệ thống máy móc có khả năng thực hiện những tác vụ mà thông thường đòi hỏi trí tuệ của con người. Những khả năng đó bao gồm học hỏi, giải quyết vấn đề, nhận dạng mẫu, hiểu ngôn ngữ tự nhiên và đưa ra quyết định.</p>
                        <p>Đối với thầy cô, AI không phải là một 'pháp thuật' cao siêu, mà là một công cụ mạnh mẽ, một 'người trợ lý thông minh' có thể hỗ trợ đắc lực trong nhiều hoạt động sư phạm.</p>

                        <h4>1.3. "Họ Hàng" Nhà AI: Học Máy và Học Sâu</h4>
                        <p>Trong gia đình AI rộng lớn, có hai 'người con' nổi bật là <strong class="glossary-term" data-term="Machine Learning">Học Máy (Machine Learning - ML)</strong> và <strong class="glossary-term" data-term="Deep Learning">Học Sâu (Deep Learning - DL)</strong>.</p>
                        <ul class="list-none pl-0 space-y-4">
                            <li>
                                <strong class="text-gold-accent">Học Máy (ML):</strong> Là một nhánh của AI, cho phép máy tính 'học' từ dữ liệu mà không cần được lập trình một cách tường minh cho từng trường hợp cụ thể. Giống như thầy cô dạy học sinh nhận biết các loại quả dựa trên nhiều ví dụ, ML cũng học từ các mẫu dữ liệu để đưa ra dự đoán hoặc quyết định.
                                <div class="image-container mt-2">
                                    <!-- Gợi ý tìm kiếm hình ảnh: "sơ đồ đơn giản dữ liệu đầu vào mô hình ML dự đoán quyết định" -->
                                    <img src="https://i.postimg.cc/Vv49brQj/visual-selection-2.png" alt="Sơ đồ Học Máy">
                                    <p class="image-caption">Sơ đồ đơn giản: Dữ liệu đầu vào -> Mô hình ML -> Dự đoán/Quyết định.</p>
                                </div>
                            </li>
                            <li>
                                <strong class="text-gold-accent">Học Sâu (DL):</strong> Là một lĩnh vực con của ML, sử dụng các <span class="glossary-term" data-term="Neural Network">mạng nơ-ron nhân tạo</span> phức tạp (lấy cảm hứng từ bộ não người) với nhiều lớp để tự động trích xuất các đặc trưng từ lượng lớn dữ liệu. Học Sâu đứng sau nhiều đột phá ấn tượng của AI gần đây như nhận diện hình ảnh, xử lý ngôn ngữ tự nhiên.
                                 <div class="image-container mt-2">
                                     <!-- Gợi ý tìm kiếm hình ảnh: "sơ đồ minh họa mạng nơ-ron nhiều lớp" -->
                                    <img src="https://i.postimg.cc/QCrkPSCj/Screenshot-2025-06-05-105757.png" alt="Sơ đồ Học Sâu">
                                    <p class="image-caption">Sơ đồ minh họa mạng nơ-ron nhiều lớp.</p>
                                </div>
                            </li>
                        </ul>
                        <p>Thầy cô không nhất thiết phải hiểu sâu về kỹ thuật, nhưng việc biết tên và vai trò của chúng sẽ giúp thầy cô tự tin hơn khi tìm hiểu các ứng dụng AI.</p>

                        <h4>1.4. Hành Trình Kỳ Diệu Của AI (Lịch Sử Phát Triển Tóm Tắt)</h4>
                        <p>Ý tưởng về máy móc thông minh đã có từ rất lâu, nhưng AI thực sự bắt đầu hình thành từ giữa thế kỷ 20.</p>
                        <ul class="list-disc pl-6 space-y-1">
                            <li><strong>Những năm 1950:</strong> Hội thảo Dartmouth (1956) được xem là khai sinh ra thuật ngữ "Trí tuệ Nhân tạo".</li>
                            <li><strong>Những "mùa đông" của AI:</strong> Các giai đoạn thiếu hụt tài trợ và tiến bộ chậm chạp.</li>
                            <li><strong>Những năm 1990 - 2000:</strong> Sự trỗi dậy của Học Máy, thành công của Deep Blue (IBM) đánh bại kỳ thủ cờ vua Garry Kasparov.</li>
                            <li><strong>Từ 2010 đến nay:</strong> Bùng nổ của Học Sâu nhờ <span class="glossary-term" data-term="Big Data">dữ liệu lớn (Big Data)</span> và sức mạnh tính toán (GPU). Sự ra đời của các <span class="glossary-term" data-term="LLM">mô hình ngôn ngữ lớn (LLMs)</span> như GPT, Gemini, mở ra kỷ nguyên AI tạo sinh.</li>
                        </ul>
                        <div class="image-container">
                            <!-- Gợi ý tìm kiếm hình ảnh: "timeline trực quan các cột mốc chính của AI" -->
                           <img src="https://i.postimg.cc/wBzH47sK/Screenshot-2025-06-05-112414.png" alt="Timeline lịch sử AI">
                           <p class="image-caption">Timeline trực quan các cột mốc chính của AI.</p>
                        </div>

                        <h4>1.5. Tại Sao Giáo Viên Cần "Kết Bạn" Với AI?</h4>
                        <ul class="list-disc pl-6 space-y-1">
                            <li><strong>Nâng cao hiệu quả công việc:</strong> Giảm tải các công việc lặp đi lặp lại, có thêm thời gian cho chuyên môn và tương tác với học sinh.</li>
                            <li><strong>Đổi mới phương pháp giảng dạy:</strong> Tạo ra các trải nghiệm học tập cá nhân hóa, hấp dẫn và tương tác hơn.</li>
                            <li><strong>Chuẩn bị cho học sinh kỹ năng của tương lai:</strong> Giúp học sinh hiểu và sẵn sàng cho một thế giới ngày càng có nhiều AI.</li>
                            <li><strong>Phát triển chuyên môn bản thân:</strong> Không bị tụt hậu trong xu thế công nghệ, mở ra những cơ hội mới.</li>
                        </ul>
                        <blockquote>
                            <p class="font-semibold text-lg">"AI không thay thế giáo viên, mà sẽ là công cụ giúp giáo viên trở nên tuyệt vời hơn!"</p>
                        </blockquote>
                        
                        <div class="interactive-box mt-8">
                            <h4 class="text-lg font-semibold text-navy-primary mb-3"><i class="fas fa-question-circle mr-2 text-gold-accent"></i>Tương Tác & Củng Cố</h4>
                            <div id="quiz-chuong1"></div>
                            <div class="mt-6">
                                <h5 class="font-semibold text-navy-primary mb-2"><i class="fas fa-video mr-2 text-gold-accent"></i>Video Đề Xuất</h5>
                                <p>Xem video "<span class="glossary-term" data-term="AI">AI</span> là gì trong 5 phút" để hiểu rõ hơn:</p>
                                <!-- Gợi ý video YouTube: "AI là gì trong 5 phút giải thích đơn giản" -->
                                <div class="video-container my-3">
                                    <iframe src="https://www.youtube.com/embed/ad79nYk2keg" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                                </div>
                                <p class="text-xs text-gray-500"></p>
                            </div>
                        </div>
                    `,
                    quiz: { id: "quiz_c1", questions: [ /* ... */ ] },
                    summary: [ /* ... */ ]
                },
                { 
                    id: "chuong2",
                    title: "Chương 2: Dữ Liệu - 'Nhiên Liệu' Vàng Của AI",
                    group: "Nền tảng AI",
                    objectives: [ /* ... */ ],
                    contentHTML: `
                        <h3 class="text-xl font-semibold text-navy-primary mt-0 mb-4">Mục tiêu Học Tập Của Chương:</h3>
                        <ul class="list-disc pl-6 mb-6 bg-blue-50 p-4 rounded-md border border-blue-200">
                            ${
                                [
                                    "Giải thích được tại sao dữ liệu lại quan trọng đối với AI.",
                                    "Phân biệt được các dạng dữ liệu cơ bản mà AI thường sử dụng (văn bản, hình ảnh, âm thanh, số liệu).",
                                    "Hiểu được nguyên tắc <span class='glossary-term' data-term='GIGO'>GIGO (Garbage In, Garbage Out)</span> và tầm quan trọng của dữ liệu chất lượng.",
                                    "Nêu được ví dụ về nguồn dữ liệu có thể sử dụng để huấn luyện AI trong lĩnh vực giáo dục."
                                ].map(obj => `<li>${obj}</li>`).join('')
                            }
                        </ul>

                        <h4>2.1. Dữ Liệu: "Thức Ăn" Không Thể Thiếu Của AI</h4>
                        <p>Nếu AI là một 'bộ não' thông minh, thì <strong class="glossary-term" data-term="Data">dữ liệu</strong> chính là 'thức ăn' nuôi dưỡng bộ não đó. Không có dữ liệu, AI không thể học hỏi, không thể đưa ra dự đoán hay quyết định chính xác. Lượng dữ liệu càng lớn và chất lượng càng cao, AI càng có khả năng trở nên 'thông minh' hơn.</p>
                        <p>Hãy tưởng tượng thầy cô dạy học sinh về các loài động vật. Thầy cô cần cho các em xem nhiều hình ảnh, video, đọc các mô tả (đó chính là dữ liệu) để các em có thể nhận biết và phân biệt được chúng. AI cũng học theo cách tương tự.</p>

                        <h4>2.2. AI "Thích Ăn" Gì? Các Dạng Dữ Liệu Phổ Biến</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 my-6">
                            <div class="p-4 bg-gray-50 rounded-lg border">
                                <h5 class="font-semibold text-navy-primary mb-2"><i class="fas fa-file-alt mr-2 text-gold-accent"></i>Văn bản (Text)</h5>
                                <p class="text-sm">Sách, báo, email, bài đăng mạng xã hội, tài liệu học tập, phản hồi của học sinh... AI có thể đọc, hiểu, tóm tắt, dịch thuật, thậm chí là tự tạo ra văn bản.</p>
                                <!-- Gợi ý tìm kiếm hình ảnh: "icon văn bản sách báo" -->
                            </div>
                            <div class="p-4 bg-gray-50 rounded-lg border">
                                <h5 class="font-semibold text-navy-primary mb-2"><i class="fas fa-image mr-2 text-gold-accent"></i>Hình ảnh (Images)</h5>
                                <p class="text-sm">Ảnh chụp, tranh vẽ, ảnh vệ tinh, ảnh y tế... AI có thể nhận diện đối tượng, khuôn mặt, phân loại hình ảnh.</p>
                                <!-- Gợi ý tìm kiếm hình ảnh: "icon máy ảnh hoặc ảnh phong cảnh" -->
                            </div>
                            <div class="p-4 bg-gray-50 rounded-lg border">
                                <h5 class="font-semibold text-navy-primary mb-2"><i class="fas fa-volume-up mr-2 text-gold-accent"></i>Âm thanh (Audio)</h5>
                                <p class="text-sm">Giọng nói, âm nhạc, tiếng động... AI có thể nhận dạng giọng nói, chuyển đổi giọng nói thành văn bản, tạo nhạc.</p>
                                <!-- Gợi ý tìm kiếm hình ảnh: "icon micro hoặc sóng âm" -->
                            </div>
                            <div class="p-4 bg-gray-50 rounded-lg border">
                                <h5 class="font-semibold text-navy-primary mb-2"><i class="fas fa-video mr-2 text-gold-accent"></i>Video</h5>
                                <p class="text-sm">Kết hợp hình ảnh và âm thanh. AI có thể phân tích nội dung video, nhận diện hành động.</p>
                                <!-- Gợi ý tìm kiếm hình ảnh: "icon máy quay phim hoặc nút play" -->
                            </div>
                            <div class="p-4 bg-gray-50 rounded-lg border md:col-span-2">
                                <h5 class="font-semibold text-navy-primary mb-2"><i class="fas fa-table mr-2 text-gold-accent"></i>Dữ liệu dạng bảng/số liệu (Tabular/Numerical Data)</h5>
                                <p class="text-sm">Điểm số học sinh, kết quả khảo sát, dữ liệu thống kê... AI có thể phân tích xu hướng, dự đoán kết quả.</p>
                                <!-- Gợi ý tìm kiếm hình ảnh: "icon bảng tính Excel hoặc biểu đồ cột" -->
                            </div>
                        </div>
                        <p>Ngoài ra, AI còn có thể xử lý các dạng dữ liệu phức tạp hơn như dữ liệu cảm biến, dữ liệu không gian địa lý...</p>
                        
                        <h4>2.3. GIGO - "Rác Vào Thì Rác Ra": Tầm Quan Trọng Của Dữ Liệu Chất Lượng</h4>
                        <p><strong class="glossary-term" data-term="GIGO">GIGO</strong> là viết tắt của <strong>"Garbage In, Garbage Out"</strong>, một nguyên tắc vàng trong khoa học máy tính và đặc biệt quan trọng với AI. Nó có nghĩa là nếu chúng ta cung cấp cho AI dữ liệu đầu vào kém chất lượng (sai lệch, không đầy đủ, nhiễu...), thì kết quả đầu ra mà AI tạo ra cũng sẽ không chính xác hoặc vô ích.</p>
                        <p>Ví dụ, nếu thầy cô huấn luyện một AI nhận diện chữ viết tay của học sinh bằng những mẫu chữ quá cẩu thả, khó đọc, thì AI đó sẽ rất khó để nhận diện chính xác chữ viết của các em sau này.</p>
                        <p>Vì vậy, việc thu thập, <span class="glossary-term" data-term="Data Cleaning">làm sạch</span> và chuẩn bị dữ liệu một cách cẩn thận là bước cực kỳ quan trọng trong bất kỳ dự án AI nào.</p>
                        <div class="image-container">
                            <!-- Gợi ý tìm kiếm hình ảnh: "sơ đồ minh họa GIGO dữ liệu xấu AI kết quả xấu" -->
                            <img src="https://i.postimg.cc/k5TZN4Qv/visual-selection.png" alt="Sơ đồ GIGO">
                            <p class="image-caption">Sơ đồ minh họa GIGO: Dữ liệu xấu -> AI -> Kết quả xấu.</p>
                        </div>

                        <h4>2.4. Nguồn Dữ Liệu Cho AI Trong Giáo Dục</h4>
                        <ul class="list-disc pl-6 space-y-1">
                            <li><strong>Dữ liệu học tập của học sinh:</strong> Kết quả bài kiểm tra, bài tập về nhà, hồ sơ học tập, tương tác trên hệ thống LMS. <em>(Lưu ý: Cần tuân thủ các quy định về <span class="glossary-term" data-term="Data Privacy">quyền riêng tư</span> và bảo mật dữ liệu).</em></li>
                            <li><strong>Tài liệu giảng dạy:</strong> Sách giáo khoa, giáo án, bài giảng, tài liệu tham khảo.</li>
                            <li><strong>Dữ liệu từ các nền tảng trực tuyến:</strong> Các khóa học mở (MOOCs), diễn đàn giáo dục, thư viện số.</li>
                            <li><strong>Dữ liệu công khai:</strong> Các bộ dữ liệu nghiên cứu về giáo dục được chia sẻ.</li>
                        </ul>
                        <p>Việc hiểu rõ các nguồn dữ liệu tiềm năng sẽ giúp thầy cô hình dung được cách AI có thể được huấn luyện để giải quyết các bài toán cụ thể trong lĩnh vực của mình.</p>
                        
                        <div class="interactive-box mt-8">
                            <h4 class="text-lg font-semibold text-navy-primary mb-3"><i class="fas fa-puzzle-piece mr-2 text-gold-accent"></i>Hoạt động: Phân Loại Dữ Liệu</h4>
                            <p class="mb-3">Hãy thử nối các mục sau vào đúng loại dữ liệu của nó (Đây là hoạt động mô tả, bạn có thể hình dung một giao diện kéo thả):</p>
                            <table class="w-full border">
                                <thead>
                                    <tr><th class="border p-2">Mục</th><th class="border p-2">Loại Dữ Liệu (Gợi ý)</th></tr>
                                </thead>
                                <tbody>
                                    <tr><td class="border p-2">Một bài báo khoa học</td><td class="border p-2">Dữ liệu Văn bản</td></tr>
                                    <tr><td class="border p-2">Bản ghi âm bài giảng</td><td class="border p-2">Dữ liệu Âm thanh</td></tr>
                                    <tr><td class="border p-2">Bảng điểm cuối kỳ</td><td class="border p-2">Dữ liệu Số liệu</td></tr>
                                    <tr><td class="border p-2">Ảnh chụp một bông hoa</td><td class="border p-2">Dữ liệu Hình ảnh</td></tr>
                                    <tr><td class="border p-2">Video hướng dẫn thí nghiệm</td><td class="border p-2">Dữ liệu Video</td></tr>
                                </tbody>
                            </table>
                            <p class="mt-4 text-sm text-gray-600">Trong một ebook tương tác thực sự, đây có thể là một hoạt động kéo thả. Hiện tại, hãy tự kiểm tra sự hiểu biết của bạn.</p>
                        </div>

                        <div class="interactive-box mt-8">
                             <h4 class="text-lg font-semibold text-navy-primary mb-3"><i class="fas fa-question-circle mr-2 text-gold-accent"></i>Quiz: Chất Lượng Dữ Liệu</h4>
                             <div id="quiz-chuong2"></div>
                        </div>
                    `,
                    quiz: { id: "quiz_c2", questions: [ /* ... */ ] },
                    summary: [ /* ... */ ]
                },
                { 
                    id: "chuong3",
                    title: "Chương 3: AI 'Ra Tay' Trong Lớp Học - Các Ứng Dụng Thực Tiễn",
                    group: "Ứng dụng AI",
                    objectives: [
                        "Liệt kê và mô tả được ít nhất 5 ứng dụng cụ thể của AI trong công tác giảng dạy và quản lý lớp học.",
                        "Phân tích được lợi ích và một số thách thức tiềm ẩn của từng ứng dụng.",
                        "Nêu được tên một vài công cụ AI (ví dụ) cho mỗi lĩnh vực ứng dụng.",
                        "Hình dung được cách áp dụng các công cụ này vào thực tế công việc của mình."
                    ],
                    contentHTML: `
                        <h3 class="text-xl font-semibold text-navy-primary mt-0 mb-4">Mục tiêu Học Tập Của Chương:</h3>
                        <ul class="list-disc pl-6 mb-6 bg-blue-50 p-4 rounded-md border border-blue-200">
                            ${
                                [
                                    "Liệt kê và mô tả được ít nhất 5 ứng dụng cụ thể của AI trong công tác giảng dạy và quản lý lớp học.",
                                    "Phân tích được lợi ích và một số thách thức tiềm ẩn của từng ứng dụng.",
                                    "Nêu được tên một vài công cụ AI (ví dụ) cho mỗi lĩnh vực ứng dụng.",
                                    "Hình dung được cách áp dụng các công cụ này vào thực tế công việc của mình."
                                ].map(obj => `<li>${obj}</li>`).join('')
                            }
                        </ul>
                        <p>Sau khi hiểu về AI và dữ liệu, chúng ta hãy cùng khám phá xem 'người trợ lý thông minh' này có thể giúp gì cho thầy cô trong lớp học và xa hơn nữa. Dưới đây là một số ứng dụng tiêu biểu mà AI đang và sẽ mang lại cho ngành giáo dục:</p>
                        
                        <h4>3.1. Cá Nhân Hóa Lộ Trình Học Tập (Personalized Learning Paths)</h4>
                        <p><strong>Mô tả:</strong> AI có thể phân tích năng lực, tốc độ học, sở thích và cả những khó khăn của từng học sinh để đề xuất lộ trình học tập, tài liệu và bài tập phù hợp nhất với mỗi em.</p>
                        <p><strong>Lợi ích:</strong> Giúp học sinh yếu theo kịp, học sinh giỏi không nhàm chán, tối ưu hóa tiềm năng của mỗi cá nhân.</p>
                        <p><strong>Ví dụ công cụ:</strong> Khan Academy (sử dụng AI để gợi ý bài tập), Knewton, DreamBox Learning.</p>
                        <div class="image-container">
                            <!-- Gợi ý tìm kiếm hình ảnh: "sơ đồ lộ trình học tập cá nhân hóa AI" -->
                            <img src="https://i.postimg.cc/9MCPtHDH/ai-chatbot-h-tr-gi-o-d-c.jpg" alt="Cá nhân hóa lộ trình học tập">
                            <p class="image-caption">Sơ đồ minh họa một lộ trình học tập cá nhân hóa.</p>
                        </div>
                        <p><strong>Thách thức:</strong> Cần lượng lớn dữ liệu học sinh, đảm bảo công bằng và tránh tạo ra sự phân hóa quá lớn.</p>

                        <h4>3.2. AI Hỗ Trợ Soạn Giáo Án, Bài Giảng, Slide</h4>
                        <p><strong>Mô tả:</strong> Các công cụ <span class="glossary-term" data-term="Generative AI">AI tạo sinh (Generative AI)</span> có thể giúp thầy cô tìm ý tưởng, tạo dàn ý, viết nội dung cơ bản, thậm chí thiết kế slide bài giảng một cách nhanh chóng.</p>
                        <p><strong>Lợi ích:</strong> Tiết kiệm thời gian chuẩn bị bài, giúp thầy cô tập trung hơn vào việc thiết kế các hoạt động sư phạm sáng tạo.</p>
                        <p><strong>Ví dụ công cụ:</strong> ChatGPT, Gemini, Gamma.app, Tome.app.</p>
                        <div class="image-container">
                             <!-- Gợi ý tìm kiếm hình ảnh: "giao diện AI tạo slide Gamma.app" hoặc "ChatGPT soạn giáo án" -->
                            <img src="https://i.postimg.cc/KzPcnCdL/Screenshot-2025-06-04-154859.png" alt="AI hỗ trợ soạn giáo án">
                            <p class="image-caption">Ảnh chụp màn hình một công cụ AI đang tạo slide hoặc dàn ý giáo án.</p>
                        </div>
                        <p><strong>Thách thức:</strong> Cần kiểm tra kỹ lưỡng tính chính xác và sự phù hợp của nội dung do AI tạo ra, đảm bảo tính sư phạm.</p>

                        <h4>3.3. Tạo Câu Hỏi, Đề Thi Tự Động (Automated Question Generation)</h4>
                        <p><strong>Mô tả:</strong> AI có thể dựa trên một đoạn văn bản, một chủ đề hoặc một bộ tài liệu để tự động tạo ra các câu hỏi trắc nghiệm, câu hỏi tự luận ở nhiều cấp độ khác nhau.</p>
                        <p><strong>Lợi ích:</strong> Giúp thầy cô nhanh chóng có được ngân hàng câu hỏi đa dạng để ôn tập, kiểm tra.</p>
                        <p><strong>Ví dụ công cụ:</strong> QuestionWell, MagicSchool AI, Quizizz (một số tính năng).</p>
                        <div class="image-container">
                            <!-- Gợi ý tìm kiếm hình ảnh: "giao diện AI tạo câu hỏi QuestionWell" -->
                            <img src="https://i.postimg.cc/X71QDFRm/Screenshot-2025-06-04-155138.png" alt="AI tạo câu hỏi tự động">
                            <p class="image-caption">Giao diện một công cụ AI đang tạo câu hỏi từ một đoạn văn bản.</p>
                        </div>
                        <p><strong>Thách thức:</strong> Chất lượng câu hỏi cần được kiểm duyệt, đôi khi AI có thể tạo câu hỏi không rõ ràng hoặc không phù hợp.</p>

                        <h4>3.4. Hệ Thống Chấm Bài và Phản Hồi Tự Động (Automated Grading & Feedback)</h4>
                        <p><strong>Mô tả:</strong> AI có thể hỗ trợ chấm các bài kiểm tra trắc nghiệm một cách nhanh chóng. Đối với bài tự luận, AI đang phát triển khả năng đưa ra những gợi ý, nhận xét ban đầu, giúp giáo viên tiết kiệm thời gian đọc và sửa chi tiết.</p>
                        <p><strong>Lợi ích:</strong> Giảm tải công việc chấm bài, giúp học sinh nhận được phản hồi nhanh hơn.</p>
                        <p><strong>Ví dụ công cụ:</strong> Gradescope, Turnitin (kiểm tra đạo văn và có thể tích hợp AI chấm sơ bộ).</p>
                        <div class="image-container">
                            <!-- Gợi ý tìm kiếm hình ảnh: "AI chấm bài trắc nghiệm" hoặc "AI đưa nhận xét bài viết" -->
                            <img src="https://i.postimg.cc/523NV4mh/cach-su-dung-chat-gpt-de-cham-diem-va-nhan-xet-bai-writing.jpg" alt="AI chấm bài tự động">
                            <p class="image-caption">Minh họa AI đang chấm bài trắc nghiệm hoặc đưa ra nhận xét cho bài viết.</p>
                        </div>
                        <p><strong>Thách thức:</strong> Khả năng chấm bài tự luận của AI vẫn còn hạn chế, chưa thể thay thế hoàn toàn sự đánh giá sâu sắc của con người, đặc biệt với các môn xã hội hoặc yêu cầu tư duy sáng tạo.</p>

                        <h4>3.5. Trợ Lý Ảo Thông Minh (Intelligent Tutoring Systems & Chatbots)</h4>
                        <p><strong>Mô tả:</strong> <span class="glossary-term" data-term="Chatbot">Chatbot AI</span> có thể trả lời các câu hỏi thường gặp của học sinh 24/7, cung cấp hướng dẫn, giải thích khái niệm, hoặc đóng vai trò như một người bạn đồng hành trong học tập.</p>
                        <p><strong>Lợi ích:</strong> Hỗ trợ học sinh ngoài giờ lên lớp, giải đáp thắc mắc kịp thời.</p>
                        <p><strong>Ví dụ công cụ:</strong> Nhiều nền tảng LMS tích hợp chatbot, hoặc các chatbot chuyên biệt như Duolingo (cho học ngoại ngữ).</p>
                        <div class="image-container">
                            <!-- Gợi ý tìm kiếm hình ảnh: "giao diện chatbot giáo dục tương tác học sinh" -->
                            <img src="https://i.postimg.cc/CKY6pYKf/Screenshot-2025-06-04-155556.png" alt="Chatbot AI giáo dục">
                            <p class="image-caption">Giao diện một chatbot đang tương tác với học sinh.</p>
                        </div>
                        <p><strong>Thách thức:</strong> Chatbot cần được huấn luyện tốt để hiểu và trả lời chính xác, tránh đưa thông tin sai lệch.</p>
                        
                        <h4>3.6. Phân Tích Dữ Liệu Học Tập (Learning Analytics)</h4>
                        <p><strong>Mô tả:</strong> AI có thể phân tích lượng lớn dữ liệu về quá trình học tập của học sinh (điểm số, thời gian hoàn thành bài, mức độ tương tác...) để phát hiện các mẫu, xu hướng, những học sinh có nguy cơ tụt lại hoặc những điểm mạnh/yếu của cả lớp.</p>
                        <p><strong>Lợi ích:</strong> Giúp giáo viên và nhà trường đưa ra những can thiệp sư phạm kịp thời, cải thiện chương trình giảng dạy.</p>
                        <p><strong>Ví dụ công cụ:</strong> Nhiều hệ thống quản lý học tập (LMS) hiện đại có tích hợp tính năng này.</p>
                        <div class="image-container">
                            <!-- Gợi ý tìm kiếm hình ảnh: "dashboard phân tích dữ liệu học tập AI" -->
                           <img src="https://i.postimg.cc/Gh8FMNbw/id-datavisualize-thumb.jpg" alt="Phân tích dữ liệu học tập bằng AI">
                           <p class="image-caption">Biểu đồ trực quan hóa dữ liệu học tập do AI phân tích.</p>
                        </div>
                        <p><strong>Thách thức:</strong> Đảm bảo quyền riêng tư dữ liệu, diễn giải kết quả phân tích một cách chính xác và có ý nghĩa.</p>

                        <h4>3.7. AI Trong Việc Tạo Trò Chơi Tương Tác, Hoạt Động Lớp Học</h4>
                        <p><strong>Mô tả:</strong> AI có thể gợi ý ý tưởng, thậm chí hỗ trợ tạo ra các trò chơi giáo dục, câu đố tương tác, kịch bản hoạt động nhóm, làm phong phú thêm trải nghiệm học tập.</p>
                        <p><strong>Lợi ích:</strong> Tăng tính hấp dẫn, động lực học tập cho học sinh.</p>
                        <p><strong>Ví dụ công cụ:</strong> Canva AI (có thể gợi ý và tạo template), các nền tảng tạo game đơn giản có tích hợp AI.</p>
                        <div class="image-container">
                            <!-- Gợi ý tìm kiếm hình ảnh: "giao diện game giáo dục tạo bởi AI Canva" -->
                           <img src="https://i.postimg.cc/GmTcNF55/Screenshot-2025-06-04-155714.png" alt="AI tạo game giáo dục">
                           <p class="image-caption">Giao diện một trò chơi giáo dục được tạo hoặc gợi ý bởi AI.</p>
                        </div>
                        <p><strong>Thách thức:</strong> Cần đảm bảo nội dung trò chơi phù hợp với mục tiêu bài học và lứa tuổi.</p>

                        <div class="interactive-box mt-8">
                            <h4 class="text-lg font-semibold text-navy-primary mb-3"><i class="fas fa-lightbulb mr-2 text-gold-accent"></i>Câu Hỏi Mở: "Bạn sẽ dùng AI cho việc gì đầu tiên?"</h4>
                            <p class="mb-2">Sau khi tìm hiểu các ứng dụng trên, thầy cô hãy thử suy nghĩ: Nếu được chọn một ứng dụng AI để áp dụng ngay vào công việc của mình, đó sẽ là gì và tại sao? Hãy chia sẻ ý tưởng của bạn!</p>
                            <textarea class="w-full p-2 border rounded" rows="3" placeholder="Ý tưởng của bạn... (Ghi chú này chỉ để bạn tự suy ngẫm)"></textarea>
                        </div>
                        <div class="interactive-box mt-4">
                            <h4 class="text-lg font-semibold text-navy-primary mb-3"><i class="fas fa-search mr-2 text-gold-accent"></i>Thử Thách Nhỏ: Khám Phá Công Cụ</h4>
                            <p class="mb-2">Hãy chọn một trong các công cụ AI được giới thiệu ở trên (ví dụ: Gamma.app để làm slide, hoặc thử hỏi ChatGPT một câu về chuyên môn của bạn). Truy cập website của công cụ đó và thử nghiệm một tính năng cơ bản. Bạn có thể sử dụng tính năng "Hỏi AI Gemini" trong ebook này để tìm hiểu thêm về cách sử dụng công cụ đó!</p>
                        </div>
                        <!-- Gợi ý video YouTube: "top ứng dụng AI cho giáo viên 2024" hoặc "hướng dẫn sử dụng [tên công cụ AI] cho giáo dục" -->
                    `,
                    summary: [
                        "AI mang đến vô vàn ứng dụng tiềm năng trong giáo dục, từ việc cá nhân hóa lộ trình học, hỗ trợ soạn bài, tạo câu hỏi, chấm bài, đến việc phân tích dữ liệu học tập và tạo các hoạt động tương tác.",
                        "Mỗi ứng dụng đều có những lợi ích thiết thực giúp nâng cao hiệu quả giảng dạy và học tập, đồng thời cũng đi kèm một số thách thức cần lưu ý.",
                        "Nhiều công cụ AI đã và đang được phát triển để hỗ trợ giáo viên trong các tác vụ này."
                    ]
                },
                { 
                    id: "chuong4",
                    title: "Chương 4: 'Giao Tiếp' Hiệu Quả Với AI - Bí Kíp Viết Prompt",
                    group: "Kỹ năng AI",
                    objectives: [ /* ... */ ],
                    contentHTML: `
                        <h3 class="text-xl font-semibold text-navy-primary mt-0 mb-4">Mục tiêu Học Tập Của Chương:</h3>
                         <ul class="list-disc pl-6 mb-6 bg-blue-50 p-4 rounded-md border border-blue-200">
                           ${
                                [
                                    "Giải thích được \"<span class='glossary-term' data-term='Prompt'>prompt</span>\" là gì và tại sao nó quan trọng khi làm việc với <span class='glossary-term' data-term='Generative AI'>AI tạo sinh</span>.",
                                    "Nắm vững được các thành phần chính của một prompt hiệu quả (vai trò, ngữ cảnh, mục tiêu, định dạng, ví dụ).",
                                    "Phân tích được ví dụ về prompt tốt và chưa tốt cho các tác vụ giáo dục.",
                                    "Thực hành viết và cải thiện prompt cho các tình huống cụ thể."
                                ].map(obj => `<li>${obj}</li>`).join('')
                            }
                        </ul>
                        <h4>4.1. Prompt - "Chìa Khóa Vàng" Mở Cánh Cửa AI</h4>
                        <p>Khi làm việc với các mô hình <span class="glossary-term" data-term="Generative AI">AI tạo sinh</span> như ChatGPT hay Gemini, <strong class="glossary-term" data-term="Prompt">"prompt"</strong> chính là câu lệnh, yêu cầu, hoặc câu hỏi mà chúng ta cung cấp cho AI để nó thực hiện một tác vụ nào đó. Nói một cách ví von, prompt giống như 'chìa khóa' để mở ra khả năng sáng tạo và xử lý thông tin của AI.</p>
                        <p>Việc viết prompt rõ ràng, cụ thể và hiệu quả (thường gọi là <strong class="glossary-term" data-term="Prompt Engineering">"prompt engineering"</strong> hay 'kỹ thuật viết prompt') là một kỹ năng cực kỳ quan trọng. Một prompt tốt có thể giúp AI tạo ra kết quả đúng ý, chất lượng cao, trong khi một prompt mơ hồ có thể dẫn đến những phản hồi không liên quan hoặc không hữu ích.</p>
                        <div class="image-container">
                            <!-- Gợi ý tìm kiếm hình ảnh: "minh họa người nhập prompt vào AI và kết quả" -->
                            <img src="https://i.postimg.cc/yx7xCDZS/Screenshot-2025-06-04-160055.png" alt="Minh họa prompt và AI">
                            <p class="image-caption">Prompt là cầu nối giao tiếp với AI.</p>
                        </div>

                        <h4>4.2. Giải Mã Công Thức PROMPT Cho Nhà Giáo Dục</h4>
                        <p>Dù không có một công thức 'bất bại' nào cho mọi tình huống, nhưng một cấu trúc prompt tốt thường bao gồm các yếu tố sau (viết tắt là <strong>PROMPT</strong>):</p>
                        <ul class="list-disc pl-6 space-y-2 my-4">
                            <li><strong>P - Persona (Vai trò của AI):</strong> Yêu cầu AI đóng một vai cụ thể. <em>Ví dụ: "Hãy đóng vai một giáo viên Lịch sử lớp 10 giàu kinh nghiệm".</em></li>
                            <li><strong>R - Request/Task (Yêu cầu/Nhiệm vụ cụ thể):</strong> Nêu rõ ràng AI cần làm gì. <em>Ví dụ: "Hãy soạn một giáo án chi tiết cho bài..."</em></li>
                            <li><strong>O - Objective/Goal (Mục tiêu/Kết quả mong muốn):</strong> Kết quả cuối cùng bạn muốn đạt được. <em>Ví dụ: "...để giúp học sinh hiểu rõ hơn về nguyên nhân của sự kiện X".</em></li>
                            <li><strong>M - More Details/Context (Thông tin chi tiết/Bối cảnh):</strong> Cung cấp thêm thông tin nền, ngữ cảnh. <em>Ví dụ: "Học sinh của tôi ở trình độ Z", "Bài giảng này dành cho tiết học 45 phút".</em></li>
                            <li><strong>P - Plus Examples/Format (Ví dụ minh họa/Định dạng đầu ra):</strong> Cung cấp ví dụ hoặc yêu cầu định dạng cụ thể. <em>Ví dụ: "Hãy trình bày dưới dạng gạch đầu dòng", "Câu trả lời cần có ít nhất 3 ý chính".</em></li>
                            <li><strong>T - Tone (Giọng điệu):</strong> Bạn muốn AI trả lời với giọng điệu như thế nào? <em>Ví dụ: Trang trọng, thân mật, hài hước...</em></li>
                        </ul>
                        <p>Không nhất thiết mọi prompt đều phải có đủ tất cả các yếu tố trên, nhưng càng cung cấp thông tin rõ ràng, AI càng dễ 'hiểu' và đáp ứng tốt hơn.</p>

                        <h4>4.3. Ví Dụ "Soi" Prompt - Tốt và Chưa Tốt</h4>
                        <p><strong>Tình huống:</strong> Soạn câu hỏi ôn tập về Chiến thắng Điện Biên Phủ cho học sinh lớp 9.</p>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 my-6">
                            <div class="p-4 border rounded-lg bg-red-50 border-red-200">
                                <h5 class="font-semibold text-red-700 mb-2"><i class="fas fa-times-circle mr-1"></i>Prompt chưa tốt:</h5>
                                <code class="block bg-white p-2 rounded text-sm">Viết câu hỏi về Điện Biên Phủ.</code>
                                <p class="text-xs mt-2 text-red-600"><em>Phân tích: Quá chung chung, không rõ đối tượng, loại câu hỏi, mục tiêu. AI có thể trả về những câu hỏi không phù hợp.</em></p>
                            </div>
                            <div class="p-4 border rounded-lg bg-green-50 border-green-200">
                                <h5 class="font-semibold text-green-700 mb-2"><i class="fas fa-check-circle mr-1"></i>Prompt tốt hơn:</h5>
                                <code class="block bg-white p-2 rounded text-sm">Hãy đóng vai một giáo viên Lịch sử lớp 9. Soạn 5 câu hỏi trắc nghiệm (mỗi câu 4 lựa chọn, 1 đáp án đúng) và 2 câu hỏi tự luận ngắn về ý nghĩa của Chiến thắng Điện Biên Phủ 1954. Mục tiêu là giúp học sinh ôn tập kiến thức cốt lõi của sự kiện này. Câu hỏi cần rõ ràng, phù hợp với trình độ học sinh lớp 9 và bám sát nội dung sách giáo khoa Lịch sử 9.</code>
                                <p class="text-xs mt-2 text-green-600"><em>Phân tích: Rõ vai trò, nhiệm vụ, số lượng, loại câu hỏi, chủ đề, mục tiêu, đối tượng, yêu cầu về chất lượng.</em></p>
                            </div>
                        </div>
                        
                        <h4>4.4. Thực Hành "Mài Giũa" Prompt Của Bạn</h4>
                        <ul class="list-disc pl-6 space-y-1">
                            <li>Cách tốt nhất để thành thạo kỹ năng viết prompt là thực hành liên tục. Hãy bắt đầu với những yêu cầu đơn giản, sau đó dần dần thêm các chi tiết và điều chỉnh.</li>
                            <li>Đừng ngại thử nghiệm nhiều cách diễn đạt khác nhau cho cùng một yêu cầu.</li>
                            <li>Nếu kết quả chưa ưng ý, hãy 'phản biện' lại với AI, yêu cầu nó làm rõ hoặc sửa đổi. Ví dụ: "Câu trả lời này hơi khó hiểu, bạn có thể giải thích đơn giản hơn không?", "Hãy bổ sung thêm ví dụ cho ý này".</li>
                        </ul>

                        <div class="interactive-box mt-8">
                            <h4 class="text-lg font-semibold text-navy-primary mb-3"><i class="fas fa-edit mr-2 text-gold-accent"></i>Bài tập: "Sửa Prompt Lỗi"</h4>
                            <p class="mb-2">Dưới đây là một prompt chưa tốt. Hãy sử dụng công thức PROMPT để viết lại thành một prompt hiệu quả hơn trong ô bên dưới.</p>
                            <p class="mb-1"><strong>Prompt gốc:</strong></p>
                            <code class="block bg-white p-3 rounded text-sm mb-3">Tóm tắt bài thơ X.</code>
                            <p class="mb-1"><strong>Prompt cải thiện của bạn:</strong></p>
                            <textarea id="improve-prompt-input" class="w-full p-3 border-2 border-gray-300 rounded-lg mb-3 h-32 resize-y focus:border-gold-accent focus:ring-1 focus:ring-gold-accent" placeholder="Viết prompt cải thiện của bạn ở đây... (Ghi chú này chỉ để bạn tự thực hành)"></textarea>
                            <button id="show-suggestion-btn" class="action-button"><i class="fas fa-lightbulb"></i>Xem Gợi Ý</button>
                            <div id="prompt-suggestion" class="hidden mt-3 p-3 bg-yellow-50 border border-yellow-200 rounded-md text-sm">
                                <p><strong>Gợi ý cải thiện:</strong></p>
                                <p><em>"Hãy đóng vai một nhà phân tích văn học. Tóm tắt bài thơ X của tác giả Y cho học sinh lớp Z. Bản tóm tắt cần nêu bật được nội dung chính, các biện pháp nghệ thuật đặc sắc và ý nghĩa của bài thơ. Độ dài khoảng 150-200 từ, trình bày rõ ràng, dễ hiểu."</em></p>
                                <p class="mt-2"><em>(Lưu ý: Thay X, Y, Z bằng thông tin cụ thể.)</em></p>
                            </div>
                        </div>
                        
                        <div class="interactive-box mt-8">
                            <h4 class="text-lg font-semibold text-navy-primary mb-3"><i class="fas fa-rocket mr-2 text-gold-accent"></i>Thử Tài Viết Prompt Của Bạn!</h4>
                            <p class="mb-3">Bây giờ, hãy thử áp dụng những gì đã học. Đặt một yêu cầu liên quan đến công việc giảng dạy của bạn cho AI Gemini. Hãy cố gắng viết một prompt thật chi tiết và hiệu quả nhé!</p>
                            <button id="trigger-gemini-from-ch4" class="action-button"><i class="fas fa-robot"></i>Hỏi Gemini Ngay</button>
                        </div>
                        <!-- Gợi ý video YouTube: "hướng dẫn viết prompt hiệu quả cho ChatGPT" hoặc "prompt engineering cho giáo viên" -->
                    `,
                    summary: [ /* ... */ ]
                },
                { 
                    id: "chuong5",
                    title: "Chương 5: Khám Phá Các 'Trợ Thủ' AI Đắc Lực",
                    group: "Công cụ AI",
                    objectives: [
                        "Nhận biết được tên và chức năng chính của ít nhất 3-5 công cụ AI phổ biến hỗ trợ giáo viên.",
                        "Nắm được các bước cơ bản để bắt đầu sử dụng một công cụ AI mới.",
                        "So sánh sơ lược được ưu nhược điểm của một vài công cụ cho cùng một tác vụ.",
                        "Có ý tưởng ứng dụng các công cụ này vào công việc cụ thể của mình."
                    ],
                    contentHTML: `
                        <h3 class="text-xl font-semibold text-navy-primary mt-0 mb-4">Mục tiêu Học Tập Của Chương:</h3>
                        <ul class="list-disc pl-6 mb-6 bg-blue-50 p-4 rounded-md border border-blue-200">
                            ${
                                [
                                    "Nhận biết được tên và chức năng chính của ít nhất 3-5 công cụ AI phổ biến hỗ trợ giáo viên.",
                                    "Nắm được các bước cơ bản để bắt đầu sử dụng một công cụ AI mới.",
                                    "So sánh sơ lược được ưu nhược điểm của một vài công cụ cho cùng một tác vụ.",
                                    "Có ý tưởng ứng dụng các công cụ này vào công việc cụ thể của mình."
                                ].map(obj => `<li>${obj}</li>`).join('')
                            }
                        </ul>
                        <p>Thế giới AI vô cùng rộng lớn với hàng ngàn công cụ khác nhau. Trong chương này, chúng ta sẽ cùng điểm qua một số 'trợ thủ' AI tiêu biểu, được nhiều giáo viên trên thế giới tin dùng và có thể giúp ích trực tiếp cho công việc của thầy cô.</p>
                        
                        <h4>5.1. Nhóm Công Cụ Tạo Nội Dung Văn Bản (Text Generation)</h4>
                        <div class="mb-6 p-4 border rounded-lg shadow-sm">
                            <h5 class="font-semibold text-lg text-gold-accent">ChatGPT (OpenAI)</h5>
                            <!-- Gợi ý tìm kiếm hình ảnh: "logo ChatGPT" -->
                            <img src="https://i.postimg.cc/vTnzYjtS/images.png" alt="ChatGPT Logo" class="my-2 h-10">
                            <p><strong>Giới thiệu:</strong> Một trong những chatbot AI nổi tiếng nhất, có khả năng trò chuyện, trả lời câu hỏi, viết văn bản, tóm tắt, dịch thuật...</p>
                            <p><strong>Tính năng cho giáo viên:</strong> Soạn dàn ý bài giảng, viết email cho phụ huynh, tạo câu hỏi ôn tập, giải thích khái niệm khó, gợi ý hoạt động lớp học.</p>
                            <p><strong>Ví dụ ứng dụng:</strong> "Thầy cô có thể yêu cầu ChatGPT: 'Hãy viết một đoạn mở bài hấp dẫn cho bài giảng về quang hợp cho học sinh lớp 6'."</p>
                            <p class="mt-1"><a href="https://chat.openai.com" target="_blank" class="text-blue-600 hover:underline">Truy cập ChatGPT <i class="fas fa-external-link-alt fa-xs"></i></a></p>
                        </div>
                        <div class="mb-6 p-4 border rounded-lg shadow-sm">
                            <h5 class="font-semibold text-lg text-gold-accent">Gemini (Google)</h5>
                             <!-- Gợi ý tìm kiếm hình ảnh: "logo Google Gemini AI" -->
                            <img src="https://i.postimg.cc/pTSmGL8g/doanh-nghi-p-t-ng-hi-u-su-t-l-m-vi-c.png" alt="Gemini Logo" class="my-2 h-10">
                            <p><strong>Giới thiệu:</strong> Mô hình ngôn ngữ lớn đa năng của Google, có khả năng tương tự ChatGPT, tích hợp sâu với các sản phẩm của Google.</p>
                            <p><strong>Tính năng cho giáo viên:</strong> Tìm kiếm thông tin nâng cao, phân tích dữ liệu (khi tích hợp với Google Sheets), tạo nội dung sáng tạo.</p>
                            <p><strong>Ví dụ ứng dụng:</strong> "Thầy cô có thể sử dụng Gemini trong ebook này để đặt câu hỏi và nhận câu trả lời ngay lập tức!"</p>
                            <p class="mt-1"><a href="https://gemini.google.com" target="_blank" class="text-blue-600 hover:underline">Truy cập Gemini <i class="fas fa-external-link-alt fa-xs"></i></a></p>
                        </div>
                        <!-- Gợi ý video YouTube: "so sánh ChatGPT và Gemini cho giáo dục" -->
<div class="video-container my-3">
    <iframe 
        src="https://www.youtube.com/embed/2nIgFYVTLX0" 
        title="So sánh ChatGPT và Gemini cho giáo dục" 
        frameborder="0" 
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
        allowfullscreen>
    </iframe>
</div>
<p class="text-xs text-gray-500 text-center">(Video so sánh hai công cụ AI phổ biến nhất hiện nay)</p>
                        <h4>5.2. Nhóm Công Cụ Tạo Bài Thuyết Trình/Slide Tự Động</h4>
                        <div class="mb-6 p-4 border rounded-lg shadow-sm">
                            <h5 class="font-semibold text-lg text-gold-accent">Gamma.app</h5>
                            <!-- Gợi ý tìm kiếm hình ảnh: "logo Gamma.app" -->
                            <img src="https://i.postimg.cc/65rQR0js/650e9c6af7212743041aa9d7-gamma-ai.png" alt="Gamma.app Logo" class="my-2 h-10">
                            <p><strong>Giới thiệu:</strong> Công cụ tạo slide, tài liệu, website nhanh chóng từ một vài dòng prompt.</p>
                            <p><strong>Tính năng cho giáo viên:</strong> Tạo slide bài giảng chỉ trong vài phút, tự động thiết kế layout, chèn hình ảnh.</p>
                            <p><strong>Ví dụ ứng dụng:</strong> "Chỉ cần nhập: 'Tạo bài thuyết trình về các hành tinh trong Hệ Mặt Trời cho học sinh tiểu học', Gamma sẽ tạo ra một bộ slide cơ bản."</p>
                            <p class="mt-1"><a href="https://gamma.app" target="_blank" class="text-blue-600 hover:underline">Truy cập Gamma.app <i class="fas fa-external-link-alt fa-xs"></i></a></p>
                        </div>
                         <div class="mb-6 p-4 border rounded-lg shadow-sm">
                            <h5 class="font-semibold text-lg text-gold-accent">Tome.app</h5>
                            <!-- Gợi ý tìm kiếm hình ảnh: "logo Tome.app" -->
                             <img src="https://i.postimg.cc/bJyc2xBT/doanh-nghi-p-t-ng-hi-u-su-t-l-m-vi-c-1.png" alt="Tome.app Logo" class="my-2 h-10">
                            <p><strong>Giới thiệu:</strong> Tương tự Gamma, tập trung vào việc kể chuyện bằng slide, tích hợp AI tạo hình ảnh.</p>
                            <p><strong>Tính năng cho giáo viên:</strong> Tạo bài giảng có tính kể chuyện, trực quan hóa ý tưởng.</p>
                            <p><strong>Ví dụ ứng dụng:</strong> "Tạo một câu chuyện tương tác về vòng đời của bướm."</p>
                             <p class="mt-1"><a href="https://tome.app" target="_blank" class="text-blue-600 hover:underline">Truy cập Tome.app <i class="fas fa-external-link-alt fa-xs"></i></a></p>
                        </div>
                        <!-- Gợi ý video YouTube: "hướng dẫn sử dụng Gamma.app tạo slide bài giảng" -->
                        
                        <h4>5.3. Nhóm Công Cụ Thiết Kế Đồ Họa và Video (Có Hỗ Trợ AI)</h4>
                        <div class="mb-6 p-4 border rounded-lg shadow-sm">
                            <h5 class="font-semibold text-lg text-gold-accent">Canva AI (Magic Studio)</h5>
                            <!-- Gợi ý tìm kiếm hình ảnh: "logo Canva" -->
                            <img src="https://i.postimg.cc/JhtzBWH0/Canva-Logo.jpg" alt="Canva Logo" class="my-2 h-10">
                            <p><strong>Giới thiệu:</strong> Canva tích hợp nhiều tính năng AI (Magic Write, Magic Design, Text to Image...) giúp thiết kế nhanh hơn.</p>
                            <p><strong>Tính năng cho giáo viên:</strong> Tạo slide, infographic, worksheet, video bài giảng ngắn, hình ảnh minh họa.</p>
                            <p><strong>Ví dụ ứng dụng:</strong> "Sử dụng Magic Write để viết mô tả cho một poster thông báo sự kiện của trường."</p>
                            <p class="mt-1"><a href="https://www.canva.com" target="_blank" class="text-blue-600 hover:underline">Truy cập Canva <i class="fas fa-external-link-alt fa-xs"></i></a></p>
                        </div>
                        <div class="mb-6 p-4 border rounded-lg shadow-sm">
                            <h5 class="font-semibold text-lg text-gold-accent">Kling AI, Vidu AI, Dreamina AI (Công cụ tạo video từ ảnh/text)</h5>
                            <!-- Gợi ý tìm kiếm hình ảnh: "logo Kling AI" hoặc "logo Vidu AI" -->
                             <img src="https://i.postimg.cc/W4rgJrkh/doanh-nghi-p-t-ng-hi-u-su-t-l-m-vi-c-2.png" alt="Video AI Tools Logo" class="my-2 h-10">
                            <p><strong>Giới thiệu:</strong> Các công cụ chuyên tạo video ngắn từ mô tả văn bản hoặc từ hình ảnh tĩnh. (Lưu ý: Tính khả dụng và dễ tiếp cận có thể thay đổi).</p>
                            <p><strong>Tính năng cho giáo viên:</strong> Tạo video minh họa bài giảng, video tóm tắt kiến thức, video kể chuyện.</p>
                            <p><strong>Ví dụ ứng dụng:</strong> "Nhập prompt: 'Tạo video hoạt hình ngắn mô tả quá trình nảy mầm của hạt đậu' để có một video trực quan cho môn Sinh học."</p>
                        </div>
                        <!-- Gợi ý video YouTube: "cách tạo video bài giảng bằng AI [tên công cụ]" -->

                        <h4>5.4. Hướng Dẫn Sử Dụng Cơ Bản (Chung cho các công cụ)</h4>
                        <ol class="list-decimal pl-6 space-y-1">
                            <li>Truy cập website của công cụ.</li>
                            <li>Đăng ký/Đăng nhập tài khoản (thường miễn phí cho các tính năng cơ bản).</li>
                            <li>Tìm hiểu giao diện chính: ô nhập prompt, các nút chức năng.</li>
                            <li>Bắt đầu với những yêu cầu đơn giản.</li>
                            <li>Tham khảo các hướng dẫn, ví dụ có sẵn trên trang của công cụ.</li>
                        </ol>
                        <blockquote><p>"Đừng ngại 'vọc vạch' và thử nghiệm, đó là cách học nhanh nhất!"</p></blockquote>

                        <div class="interactive-box mt-8">
                            <h4 class="text-lg font-semibold text-navy-primary mb-3"><i class="fas fa-mouse-pointer mr-2 text-gold-accent"></i>Hoạt động: "Bạn Sẽ Chọn Trợ Thủ Nào?"</h4>
                            <p class="mb-2">Dựa trên nhu cầu công việc hiện tại của thầy cô, hãy chọn ra 1-2 công cụ AI trong danh sách trên mà thầy cô muốn tìm hiểu sâu hơn. Hãy giải thích lý do lựa chọn của mình.</p>
                            <textarea class="w-full p-2 border rounded" rows="3" placeholder="Lựa chọn và lý do của bạn... (Ghi chú này chỉ để bạn tự suy ngẫm)"></textarea>
                        </div>
                         <div class="interactive-box mt-4">
                            <h4 class="text-lg font-semibold text-navy-primary mb-3"><i class="fas fa-question-circle mr-2 text-gold-accent"></i>Câu Hỏi Mở: "Công Cụ AI Yêu Thích Của Bạn Là Gì?"</h4>
                            <p class="mb-2">Ngoài những công cụ đã kể trên, thầy cô có biết hoặc đang sử dụng công cụ AI nào khác hữu ích cho giáo dục không? Hãy chia sẻ để mọi người cùng học hỏi!</p>
                             <textarea class="w-full p-2 border rounded" rows="3" placeholder="Chia sẻ công cụ AI khác... (Ghi chú này chỉ để bạn tự suy ngẫm)"></textarea>
                        </div>
                    `,
                    summary: [
                        "Có rất nhiều công cụ AI hữu ích cho giáo viên trong các lĩnh vực như tạo nội dung văn bản, thiết kế bài giảng, đồ họa, video.",
                        "Các công cụ phổ biến bao gồm ChatGPT, Gemini, Gamma, Canva AI...",
                        "Việc làm quen và thử nghiệm các công cụ này sẽ giúp thầy cô tìm ra 'trợ thủ' đắc lực cho riêng mình."
                    ]
                },
                { 
                    id: "chuong6",
                    title: "Chương 6: AI Trong Giáo Dục - Cơ Hội, Thách Thức và Trách Nhiệm",
                    group: "AI và Xã hội",
                    objectives: [
                        "Nhận diện được những cơ hội lớn mà AI mang lại cho sự phát triển của giáo dục.",
                        "Phân tích được các thách thức và vấn đề đạo đức tiềm ẩn khi triển khai AI trong trường học (thiên kiến, quyền riêng tư, bản quyền).",
                        "Hiểu được vai trò và trách nhiệm của nhà giáo dục trong kỷ nguyên AI.",
                        "Có ý tưởng về cách hướng dẫn học sinh sử dụng AI một cách thông minh, có trách nhiệm."
                    ],
                    contentHTML: `
                        <h3 class="text-xl font-semibold text-navy-primary mt-0 mb-4">Mục tiêu Học Tập Của Chương:</h3>
                        <ul class="list-disc pl-6 mb-6 bg-blue-50 p-4 rounded-md border border-blue-200">
                            ${
                                [
                                    "Nhận diện được những cơ hội lớn mà AI mang lại cho sự phát triển của giáo dục.",
                                    "Phân tích được các thách thức và vấn đề đạo đức tiềm ẩn khi triển khai AI trong trường học (<span class='glossary-term' data-term='AI Bias'>thiên kiến</span>, <span class='glossary-term' data-term='Data Privacy'>quyền riêng tư</span>, bản quyền).",
                                    "Hiểu được vai trò và trách nhiệm của nhà giáo dục trong kỷ nguyên AI.",
                                    "Có ý tưởng về cách hướng dẫn học sinh sử dụng AI một cách thông minh, có trách nhiệm."
                                ].map(obj => `<li>${obj}</li>`).join('')
                            }
                        </ul>
                        <p>AI không chỉ là một công cụ công nghệ, nó còn mang đến những thay đổi sâu sắc cho cách chúng ta dạy và học. Bên cạnh những cơ hội to lớn, chúng ta cũng cần nhận diện và đối mặt với những thách thức và trách nhiệm đi kèm.</p>

                        <h4>6.1. Cơ Hội Vàng Cho Đổi Mới Giáo Dục</h4>
                        <ul class="list-disc pl-6 space-y-1">
                            <li><strong>Nâng cao chất lượng giảng dạy:</strong> Cá nhân hóa học tập, cung cấp tài liệu đa dạng, giải phóng giáo viên khỏi các tác vụ thủ công.</li>
                            <li><strong>Tăng cường sự tham gia của học sinh:</strong> Tạo ra các trải nghiệm học tập tương tác, hấp dẫn, phù hợp với sở thích cá nhân.</li>
                            <li><strong>Mở rộng khả năng tiếp cận giáo dục:</strong> AI có thể hỗ trợ học sinh ở vùng sâu vùng xa, học sinh có nhu cầu đặc biệt.</li>
                            <li><strong>Phát triển kỹ năng thế kỷ 21:</strong> Giúp học sinh làm quen và sử dụng thành thạo công nghệ, tư duy phản biện, giải quyết vấn đề.</li>
                        </ul>
                        <div class="image-container">
                            <!-- Gợi ý tìm kiếm hình ảnh: "cây công nghệ mọc từ sách giáo dục AI" -->
                           <img src="https://i.postimg.cc/52bYWk8R/images.jpg" alt="Cơ hội AI trong giáo dục">
                           <p class="image-caption">Một hình ảnh biểu tượng cho sự phát triển, đổi mới trong giáo dục nhờ AI.</p>
                        </div>

                        <h4>6.2. Những "Góc Khuất" Cần Lưu Tâm - Thách Thức và Vấn Đề Đạo Đức</h4>
                        <div class="space-y-4">
                            <div>
                                <h5 class="font-semibold text-gold-accent">Thiên Kiến (Bias) Trong AI</h5>
                                <p>"AI học từ dữ liệu do con người tạo ra. Nếu dữ liệu đầu vào chứa đựng những định kiến (về giới tính, chủng tộc, vùng miền...), AI có thể 'học' và khuếch đại những định kiến đó trong các quyết định hoặc nội dung nó tạo ra."</p>
                                <p>"Ví dụ: Một AI được huấn luyện chủ yếu bằng hình ảnh các nhà khoa học nam có thể gặp khó khăn trong việc nhận diện hoặc tạo ra hình ảnh nhà khoa học nữ."</p>
                                <p>"Trong giáo dục, điều này có thể dẫn đến sự bất bình đẳng hoặc củng cố những khuôn mẫu tiêu cực."</p>
                            </div>
                            <div>
                                <h5 class="font-semibold text-gold-accent">Quyền Riêng Tư Dữ Liệu (Data Privacy)</h5>
                                <p>"Để cá nhân hóa học tập, AI cần thu thập và phân tích rất nhiều dữ liệu của học sinh. Việc bảo vệ những dữ liệu nhạy cảm này khỏi bị lạm dụng, rò rỉ là vô cùng quan trọng."</p>
                                <p>"Thầy cô và nhà trường cần hiểu rõ các quy định về bảo mật dữ liệu và lựa chọn các công cụ AI uy tín, minh bạch về chính sách dữ liệu."</p>
                            </div>
                            <div>
                                <h5 class="font-semibold text-gold-accent">Vấn Đề Bản Quyền (Copyright)</h5>
                                <p>"Nội dung do AI tạo ra (văn bản, hình ảnh, âm nhạc...) đặt ra những câu hỏi phức tạp về quyền tác giả. Ai sở hữu những nội dung này? Có được phép sử dụng chúng một cách tự do không?"</p>
                                <p>"Thầy cô cần cẩn trọng khi sử dụng nội dung do AI tạo cho mục đích thương mại hoặc xuất bản, và nên tìm hiểu về giấy phép của từng công cụ."</p>
                            </div>
                            <div>
                                <h5 class="font-semibold text-gold-accent">Sự Phụ Thuộc Vào Công Nghệ và Nguy Cơ "Lười Tư Duy"</h5>
                                <p>"Việc quá phụ thuộc vào AI có thể làm giảm khả năng tư duy độc lập, sáng tạo của cả giáo viên và học sinh."</p>
                                <p>"Cần cân bằng giữa việc sử dụng AI như một công cụ hỗ trợ và việc rèn luyện các kỹ năng tư duy cốt lõi."</p>
                            </div>
                        </div>
                         <div class="image-container">
                            <!-- Gợi ý tìm kiếm hình ảnh: "ẩn dụ về thách thức của AI con đường nhiều ngã rẽ" -->
                           <img src="https://i.postimg.cc/8CL0fc75/10-1.jpg" alt="Thách thức của AI">
                           <p class="image-caption">Một hình ảnh ẩn dụ về các "góc khuất" hoặc thách thức của AI.</p>
                        </div>
                        <!-- Gợi ý video YouTube: "đạo đức AI trong giáo dục" hoặc "thách thức khi ứng dụng AI vào trường học" -->

                        <h4>6.3. Vai Trò Của Nhà Giáo Dục Trong Kỷ Nguyên AI</h4>
                        <ul class="list-disc pl-6 space-y-1">
                            <li>Không chỉ là người truyền thụ kiến thức: Mà còn là người hướng dẫn, cố vấn, người khơi gợi sự tò mò và kỹ năng học tập suốt đời.</li>
                            <li>Người đánh giá và lựa chọn công cụ AI phù hợp: Hiểu rõ ưu nhược điểm của từng công cụ để ứng dụng hiệu quả.</li>
                            <li>Người thúc đẩy tư duy phản biện về AI: Giúp học sinh hiểu cách AI hoạt động, nhận diện thiên kiến, và sử dụng AI một cách có ý thức.</li>
                            <li>Người tiên phong trong đổi mới sáng tạo: Chủ động tìm tòi, thử nghiệm các phương pháp dạy học mới với sự hỗ trợ của AI.</li>
                        </ul>

                        <h4>6.4. Dạy Học Sinh "Chơi" Cùng AI Một Cách Thông Minh</h4>
                        <ul class="list-disc pl-6 space-y-1">
                            <li>Hướng dẫn về tính xác thực của thông tin: "Không phải mọi thứ AI nói đều đúng. Hãy dạy các em cách kiểm tra chéo thông tin từ nhiều nguồn."</li>
                            <li>Khuyến khích sự sáng tạo và tư duy độc lập: "AI là công cụ, không phải là người làm thay. Hãy dùng AI để tìm ý tưởng, nhưng sản phẩm cuối cùng phải mang dấu ấn cá nhân."</li>
                            <li>Thảo luận về <span class="glossary-term" data-term="AI Ethics">đạo đức</span> và trách nhiệm: "Sử dụng AI để làm điều tốt, tránh lạm dụng hoặc gây hại."</li>
                            <li>Nhấn mạnh tầm quan trọng của kỹ năng con người: "Những kỹ năng như giao tiếp, hợp tác, giải quyết vấn đề phức tạp, trí tuệ cảm xúc là những thứ AI khó có thể thay thế."</li>
                        </ul>
                        
                        <div class="interactive-box mt-8">
                            <h4 class="text-lg font-semibold text-navy-primary mb-3"><i class="fas fa-comments mr-2 text-gold-accent"></i>Tình Huống Thảo Luận: Đạo Đức AI</h4>
                            <p class="mb-2"><strong>Tình huống 1:</strong> Một AI chấm bài văn tự động luôn cho điểm cao hơn với các bài viết sử dụng nhiều thuật ngữ phức tạp, dù nội dung có thể chưa sâu sắc. Điều này có thể dẫn đến vấn đề gì?</p>
                            <textarea class="w-full p-2 border rounded mb-4" rows="2" placeholder="Suy nghĩ của bạn về tình huống 1... (Ghi chú này chỉ để bạn tự suy ngẫm)"></textarea>
                            <p class="mb-2"><strong>Tình huống 2:</strong> Một học sinh sử dụng AI để viết toàn bộ bài luận của mình. Theo thầy cô, đây có phải là hành vi gian lận không? Làm thế nào để xử lý tình huống này?</p>
                            <textarea class="w-full p-2 border rounded" rows="2" placeholder="Suy nghĩ của bạn về tình huống 2... (Ghi chú này chỉ để bạn tự suy ngẫm)"></textarea>
                        </div>
                        <div class="interactive-box mt-4">
                            <h4 class="text-lg font-semibold text-navy-primary mb-3"><i class="fas fa-user-cog mr-2 text-gold-accent"></i>Câu Hỏi Tự Phản Ánh</h4>
                            <p class="mb-2">Theo thầy cô, thách thức lớn nhất khi ứng dụng AI vào trường học của mình là gì?</p>
                            <textarea class="w-full p-2 border rounded mb-4" rows="2" placeholder="Thách thức lớn nhất... (Ghi chú này chỉ để bạn tự suy ngẫm)"></textarea>
                            <p class="mb-2">Thầy cô có ý tưởng nào để giúp học sinh của mình hình thành thái độ sử dụng AI tích cực và có trách nhiệm không?</p>
                            <textarea class="w-full p-2 border rounded" rows="2" placeholder="Ý tưởng của bạn... (Ghi chú này chỉ để bạn tự suy ngẫm)"></textarea>
                        </div>
                    `,
                    summary: [
                        "AI mở ra nhiều cơ hội để đổi mới và cải thiện chất lượng giáo dục.",
                        "Tuy nhiên, cần nhận diện và giải quyết các thách thức về thiên kiến, quyền riêng tư, bản quyền và nguy cơ phụ thuộc vào công nghệ.",
                        "Nhà giáo dục đóng vai trò then chốt trong việc định hướng sử dụng AI một cách hiệu quả, có đạo đức và trách nhiệm.",
                        "Việc trang bị cho học sinh kỹ năng sử dụng AI thông minh là một nhiệm vụ quan trọng."
                    ]
                },
                { 
                    id: "chuong7",
                    title: "Chương 7: Thực Hành Nâng Cao - Xây Dựng Dự Án AI Nhỏ",
                    group: "Thực hành",
                    objectives: [
                        "Vận dụng được kiến thức từ các chương trước để thực hiện một quy trình ứng dụng AI cụ thể.",
                        "Trải nghiệm thực tế việc sử dụng các công cụ AI để tạo ra một sản phẩm giáo dục đơn giản.",
                        "Tự đánh giá được kết quả và những khó khăn gặp phải trong quá trình thực hành."
                    ],
                    contentHTML: `
                        <h3 class="text-xl font-semibold text-navy-primary mt-0 mb-4">Mục tiêu Học Tập Của Chương:</h3>
                        <ul class="list-disc pl-6 mb-6 bg-blue-50 p-4 rounded-md border border-blue-200">
                            ${
                                [
                                    "Vận dụng được kiến thức từ các chương trước để thực hiện một quy trình ứng dụng AI cụ thể.",
                                    "Trải nghiệm thực tế việc sử dụng các công cụ AI để tạo ra một sản phẩm giáo dục đơn giản.",
                                    "Tự đánh giá được kết quả và những khó khăn gặp phải trong quá trình thực hành."
                                ].map(obj => `<li>${obj}</li>`).join('')
                            }
                        </ul>
                        <p>Chương này sẽ tập trung vào việc hướng dẫn các quy trình thực hành cụ thể, giúp thầy cô tự tay tạo ra các sản phẩm giáo dục với sự hỗ trợ của AI.</p>

                        <h4>7.1. Dự Án 1: Quy Trình Soạn Giáo Án Slide Siêu Tốc Với AI</h4>
                        <p><strong>Mục tiêu dự án:</strong> Tạo một bộ slide bài giảng cơ bản cho một chủ đề tự chọn bằng cách kết hợp NotebookLM (hoặc công cụ tương tự để quản lý tài liệu) và các AI tạo slide (Gamma, ChatGPT...).</p>
                        <p><strong>Các bước thực hiện:</strong></p>
                        <ol class="list-decimal pl-6 space-y-2">
                            <li><strong>Chuẩn bị "Nguyên Liệu":</strong> Tải lên sách giáo khoa (PDF), kế hoạch giảng dạy, chuẩn đầu ra vào một không gian làm việc như Google Drive hoặc NotebookLM.
                                <div class="image-container my-2">
                                    <!-- Gợi ý tìm kiếm hình ảnh: "giao diện NotebookLM tải tài liệu" -->
                                    <img src="https://i.postimg.cc/T1cyKV69/Screenshot-2025-06-04-160506.png" alt="NotebookLM tải tài liệu">
                                </div>
                            </li>
                            <li><strong>"Nhai" Tài Liệu Với AI Chatbot:</strong> Sử dụng AI Chatbot (trong NotebookLM hoặc ChatGPT có khả năng đọc file) để tóm tắt nội dung chính của một chương/bài từ SGK đã tải lên. (Ví dụ prompt: "Dựa vào file SGK Khoa học lớp 4 đã tải lên, hãy tóm tắt những ý chính của Bài 5: Nước và vai trò của nước.")</li>
                            <li><strong>"Tinh Chỉnh" Dàn Ý Với ChatGPT:</strong> Copy nội dung tóm tắt, yêu cầu ChatGPT (hoặc Gemini) sắp xếp lại thành dàn ý chi tiết cho bài giảng. (Ví dụ prompt: "Đây là tóm tắt... Hãy giúp tôi xây dựng dàn ý chi tiết cho bài giảng 45 phút...")</li>
                            <li><strong>Biến Dàn Ý Thành "Thẻ Slide":</strong> Yêu cầu AI chuyển dàn ý chi tiết thành cấu trúc các thẻ slide (tiêu đề và gạch đầu dòng). (Ví dụ prompt: "Từ dàn ý..., hãy tạo cấu trúc nội dung cho khoảng 10-12 slide...")</li>
                            <li><strong>Xử Lý Ký Tự Đặc Biệt (Nếu Cần):</strong> Với các môn có công thức (Toán, Lý, Hóa), có thể cần copy nội dung qua công cụ hỗ trợ LaTeX (như Bibcit) để đảm bảo hiển thị đúng.</li>
                            <li><strong>"Hô Biến" Ra Slide Với Gamma AI:</strong> Truy cập Gamma.app, dán nội dung cấu trúc thẻ slide vào và để AI tự động tạo slide, chọn template.
                                <div class="image-container my-2">
                                     <!-- Gợi ý tìm kiếm hình ảnh: "giao diện Gamma.app tạo slide từ text" -->
                                    <img src="https://i.postimg.cc/SQ9fy3zS/Screenshot-2025-06-04-160537.png" alt="Gamma tạo slide">
                                </div>
                            </li>
                            <li><strong>"Tút Tát" Nhan Sắc Slide:</strong> Chỉnh sửa cơ bản trong Gamma hoặc tải về (PDF/PPTX) và đưa lên Canva để hoàn thiện.
                                <div class="image-container my-2">
                                    <!-- Gợi ý tìm kiếm hình ảnh: "giao diện Canva chỉnh sửa slide bài giảng" -->
                                    <img src="https://i.postimg.cc/5t9sygWP/Screenshot-2025-06-04-160913.png" alt="Canva chỉnh sửa slide">
                                </div>
                            </li>
                            <li><strong>Hoàn Thiện và Sử Dụng:</strong> Kiểm tra lại toàn bộ nội dung, chính tả, hình ảnh.</li>
                        </ol>
                        <p class="mt-3"><strong>Sản phẩm mong đợi:</strong> Một file bài giảng (PPTX, PDF hoặc link Gamma) hoàn chỉnh.</p>
                        <div class="interactive-box mt-4">
                            <h5 class="font-semibold text-navy-primary mb-2"><i class="fas fa-tasks mr-2 text-gold-accent"></i>Thử thách nhỏ:</h5>
                            <p>"Hãy thử áp dụng quy trình này để tạo slide cho một bài học bạn sắp dạy!"</p>
                        </div>
                        <!-- Gợi ý video YouTube: "hướng dẫn dùng NotebookLM và Gamma.app soạn giáo án" -->

                        <h4>7.2. Dự Án 2: Từ Trang Sách Tĩnh Đến Video Bài Giảng Sinh Động</h4>
                        <p><strong>Mục tiêu dự án:</strong> Tạo một video ngắn giải thích một khái niệm hoặc tóm tắt một bài học từ hình ảnh sách giáo khoa.</p>
                        <p><strong>Các bước thực hiện (chi tiết hóa 9 bước bạn đã cung cấp):</strong></p>
                         <ol class="list-decimal pl-6 space-y-2">
                            <li>Chụp ảnh rõ nét trang sách giáo khoa hoặc các hình ảnh minh họa cần thiết.</li>
                            <li>Sử dụng ChatGPT hoặc Gemini để viết kịch bản chi tiết cho video dựa trên nội dung trang sách. (Ví dụ prompt: "Dựa vào hình ảnh trang sách này [mô tả nội dung], hãy viết kịch bản cho một video giải thích 2 phút về khái niệm X cho học sinh lớp Y.")</li>
                            <li>Sử dụng công cụ Text-to-Speech (ví dụ: Vbee.vn, FPT.AI, Google Cloud Text-to-Speech) để tạo file âm thanh lồng tiếng từ kịch bản.</li>
                            <li>Nếu cần thêm hình ảnh minh họa, sử dụng các công cụ AI tạo ảnh (ví dụ: Midjourney, DALL-E trong Canva, Bing Image Creator) với các prompt mô tả.</li>
                            <li>Sử dụng các công cụ AI tạo video từ ảnh/text (ví dụ: Kling, Vidu AI, RunwayML, Pictory.ai) để làm các hình ảnh có sẵn chuyển động hoặc tạo video từ kịch bản.</li>
                            <li>Sử dụng một trình biên tập video (ví dụ: CapCut, InShot, Adobe Premiere Rush, DaVinci Resolve) để ghép các cảnh video, hình ảnh đã tạo và file âm thanh lồng tiếng.</li>
                            <li>Thêm hiệu ứng chuyển cảnh, tiêu đề, văn bản chú thích (nếu cần).</li>
                            <li>Thêm nhạc nền không bản quyền phù hợp.</li>
                            <li>Kiểm tra, chỉnh sửa và xuất video với định dạng phù hợp.</li>
                        </ol>
                        <div class="image-container my-2">
                            <!-- Gợi ý tìm kiếm hình ảnh: "sơ đồ quy trình tạo video bài giảng AI từ ảnh sách" -->
                            <img src="https://i.postimg.cc/NfrkpMck/doanh-nghi-p-t-ng-hi-u-su-t-l-m-vi-c.png" alt="Quy trình tạo video AI">
                            <p class="image-caption">Sơ đồ trực quan hóa quy trình tạo video từ ảnh SGK.</p>
                        </div>
                        <!-- Gợi ý video YouTube: "cách làm video bài giảng từ ảnh bằng AI Kling" hoặc "tạo video giáo dục với AI" -->

                        <h4>7.3. Dự Án 3: "Gamify" Lớp Học - Tạo Trò Chơi Tương Tác Với AI</h4>
                        <p><strong>Mục tiêu dự án:</strong> Tạo một trò chơi giáo dục đơn giản (ví dụ: ô chữ, trắc nghiệm tương tác) bằng Canva AI hoặc các công cụ tương tự.</p>
                        <p><strong>Các bước thực hiện (chi tiết hóa 7 bước bạn đã cung cấp):</strong></p>
                        <ol class="list-decimal pl-6 space-y-2">
                            <li>Xác định mục tiêu học tập và nội dung kiến thức cần đưa vào trò chơi.</li>
                            <li>Sử dụng AI Chatbot (ChatGPT, Gemini) để tạo bộ câu hỏi và đáp án cho trò chơi (trắc nghiệm, điền từ, câu hỏi cho ô chữ). (Ví dụ prompt: "Tạo 10 câu hỏi trắc nghiệm về chủ đề X cho học sinh lớp Y, mỗi câu có 4 lựa chọn và 1 đáp án đúng.")</li>
                            <li>Mở Canva, chọn một mẫu thiết kế phù hợp (ví dụ: bài thuyết trình, bài đăng Instagram).</li>
                            <li>Sử dụng các tính năng AI của Canva (Magic Write, Magic Media - Text to Image) để tạo hình nền, các yếu tố đồ họa cho trò chơi theo chủ đề.</li>
                            <li>Sử dụng các công cụ văn bản, hình khối của Canva để thiết kế giao diện trò chơi, các ô câu hỏi, ô chữ, các nút bấm.</li>
                            <li>Nếu làm game trắc nghiệm có nhiều slide, sao chép slide để tạo các trang câu hỏi và trang đáp án/giải thích. Sử dụng tính năng "Liên kết" của Canva để nối các nút bấm (ví dụ: nút "Đáp án A") đến đúng trang phản hồi.</li>
                            <li>Kiểm tra kỹ các liên kết và tính logic của trò chơi. Chia sẻ dưới dạng "Đường liên kết chỉ xem" hoặc tải về dưới dạng PDF tương tác (nếu hỗ trợ).</li>
                        </ol>
                         <div class="image-container my-2">
                            <!-- Gợi ý tìm kiếm hình ảnh: "giao diện Canva tạo game giáo dục AI" -->
                            <img src="https://placehold.co/500x300/0A2342/FBC02D?text=Canva+AI+Tạo+Game" alt="Canva AI tạo game">
                            <p class="image-caption">Giao diện Canva AI đang tạo một trò chơi đơn giản.</p>
                        </div>
                        <!-- Gợi ý video YouTube: "hướng dẫn tạo game tương tác bằng Canva AI" -->
                        
                        <div class="interactive-box mt-8">
                            <h4 class="text-lg font-semibold text-navy-primary mb-3"><i class="fas fa-clipboard-list mr-2 text-gold-accent"></i>Checklist Thực Hiện Dự Án</h4>
                            <ul class="list-none pl-0 space-y-1">
                                <li><input type="checkbox" class="mr-2 accent-gold-accent"> Đã chọn 1 trong 3 dự án để thực hiện.</li>
                                <li><input type="checkbox" class="mr-2 accent-gold-accent"> Đã chuẩn bị đủ "nguyên liệu" (tài liệu, ý tưởng câu hỏi).</li>
                                <li><input type="checkbox" class="mr-2 accent-gold-accent"> Đã sử dụng ít nhất 2 công cụ AI khác nhau (nếu dự án yêu cầu).</li>
                                <li><input type="checkbox" class="mr-2 accent-gold-accent"> Đã tạo ra sản phẩm cuối cùng (dù là bản nháp).</li>
                            </ul>
                        </div>
                        <div class="interactive-box mt-4">
                            <h4 class="text-lg font-semibold text-navy-primary mb-3"><i class="fas fa-marker mr-2 text-gold-accent"></i>Khung Ghi Chú Kết Quả/Khó Khăn</h4>
                            <textarea class="w-full p-2 border rounded" rows="4" placeholder="Ghi lại kết quả đạt được và những khó khăn bạn gặp phải trong quá trình thực hành dự án... (Ghi chú này chỉ để bạn tự suy ngẫm)"></textarea>
                        </div>
                         <div class="interactive-box mt-4">
                            <h4 class="text-lg font-semibold text-navy-primary mb-3"><i class="fas fa-graduation-cap mr-2 text-gold-accent"></i>Câu Hỏi Mở: "Bạn đã học được gì từ dự án này?"</h4>
                             <textarea class="w-full p-2 border rounded" rows="3" placeholder="Chia sẻ những điều bạn học được... (Ghi chú này chỉ để bạn tự suy ngẫm)"></textarea>
                        </div>
                    `,
                    summary: [
                        "Thực hành là cách tốt nhất để làm chủ công nghệ.",
                        "Bằng cách kết hợp các công cụ AI khác nhau, thầy cô có thể tạo ra những sản phẩm giáo dục chất lượng một cách hiệu quả.",
                        "Đừng ngại thử nghiệm và tùy chỉnh các quy trình cho phù hợp với nhu cầu của bản thân."
                    ]
                },
                { 
                    id: "loiKet",
                    title: "Lời Kết",
                    group: "Tổng kết",
                    contentHTML: `
                        <p>Hành trình khám phá thế giới AI dành cho nhà giáo dục của chúng ta đến đây là tạm kết thúc, nhưng cánh cửa học hỏi và ứng dụng AI vẫn luôn rộng mở. Ebook này đã cung cấp cho thầy cô những kiến thức nền tảng, những công cụ hữu ích và những quy trình thực tiễn để bắt đầu.</p>
                        <h4 class="text-lg font-semibold text-navy-primary mt-6 mb-3">Tóm tắt những điểm chính của ebook:</h4>
                        <ul class="list-disc pl-6 mb-4 space-y-1">
                            <li>AI là gì và tầm quan trọng của nó trong giáo dục.</li>
                            <li>Vai trò của dữ liệu và kỹ năng viết prompt.</li>
                            <li>Các ứng dụng và công cụ AI tiêu biểu.</li>
                            <li>Cơ hội, thách thức và trách nhiệm của nhà giáo dục.</li>
                            <li>Các bước thực hành cụ thể.</li>
                        </ul>
                        <h4 class="text-lg font-semibold text-navy-primary mt-6 mb-3">Khuyến khích thầy cô tiếp tục khám phá và ứng dụng AI:</h4>
                        <p>"AI đang phát triển không ngừng, mỗi ngày đều có những công cụ và tính năng mới. Hãy giữ tinh thần ham học hỏi, sẵn sàng thử nghiệm và chia sẻ kinh nghiệm với đồng nghiệp."</p>
                        <p>"Hãy nhớ rằng, AI là trợ thủ, không phải là người thay thế. Mục tiêu cuối cùng của chúng ta là sử dụng AI để nâng cao chất lượng dạy và học, khơi gợi tiềm năng và niềm đam mê học tập của học sinh."</p>
                        <h4 class="text-lg font-semibold text-navy-primary mt-6 mb-3">Nguồn tài liệu/cộng đồng để học hỏi thêm:</h4>
                        <ul class="list-disc pl-6 mb-4 space-y-1">
                            <li><strong>Blog/Website (Tiếng Anh):</strong> EdTechReview, EdSurge, ClassTechTips.</li>
                            <li><strong>Cộng đồng Facebook (Việt Nam):</strong> Tìm kiếm các nhóm như "Giáo viên sáng tạo cùng AI", "Ứng dụng công nghệ thông tin trong dạy học"...</li>
                            <li><strong>Kênh YouTube:</strong> Theo dõi các kênh của chuyên gia giáo dục chia sẻ về AI và công nghệ.</li>
                        </ul>
                        
                        <div class="mt-8 pt-6 border-t-2 border-gold-accent text-center">
                            <h4 class="text-lg font-semibold text-navy-primary mb-3">Tư vấn chuyên sâu về ứng dụng AI trong giáo dục:</h4>
                            <p>Để được tư vấn chuyên sâu, vui lòng liên hệ thầy <strong>Bùi Đăng Minh</strong>:</p>
                            <p><i class="fas fa-phone text-gold-accent"></i> Điện thoại: 0918888691</p>
                            <p><i class="fas fa-envelope text-gold-accent"></i> Email: pademy.vn@gmail.com</p>
                        </div>

                        <p class="mt-8 font-semibold text-lg text-center text-gold-accent">Chúc thầy cô thành công trên hành trình chinh phục AI và mang đến những bài học đột phá, truyền hứng cho học trò của mình!</p>
                        
                        <div class="interactive-box mt-10 text-center">
                            <h4 class="text-lg font-semibold text-navy-primary mb-3">Phản Hồi Về Ebook</h4>
                            <p class="mb-4">Chúng tôi rất mong nhận được những ý kiến đóng góp của thầy cô để hoàn thiện ebook này hơn nữa. Xin vui lòng chia sẻ cảm nhận và đề xuất của bạn!</p>
                            <button onclick="alert('Cảm ơn bạn đã quan tâm! Tính năng gửi phản hồi đang được phát triển.')" class="action-button"><i class="fas fa-comment-dots"></i>Gửi Phản Hồi</button>
                        </div>
                    `
                }
            ],
            glossary: {
                "AI": "<strong>Trí tuệ Nhân tạo (Artificial Intelligence - AI):</strong> Là lĩnh vực khoa học máy tính tập trung vào việc tạo ra các hệ thống máy móc có khả năng thực hiện những tác vụ mà thông thường đòi hỏi trí tuệ của con người. Bao gồm học hỏi, giải quyết vấn đề, nhận dạng mẫu, hiểu ngôn ngữ tự nhiên và đưa ra quyết định.",
                "Machine Learning": "<strong>Học Máy (Machine Learning - ML):</strong> Một nhánh của AI cho phép hệ thống tự học hỏi từ dữ liệu để cải thiện hiệu suất mà không cần lập trình rõ ràng cho từng trường hợp cụ thể.",
                "Deep Learning": "<strong>Học Sâu (Deep Learning - DL):</strong> Một lĩnh vực con của ML sử dụng mạng nơ-ron nhân tạo với nhiều lớp (lấy cảm hứng từ bộ não người) để tự động trích xuất các đặc trưng phức tạp từ lượng lớn dữ liệu. Đứng sau nhiều đột phá của AI hiện đại.",
                "Neural Network": "<strong>Mạng Nơ-ron (Neural Network):</strong> Một hệ thống tính toán lấy cảm hứng từ cấu trúc và chức năng của mạng nơ-ron sinh học trong não bộ, được sử dụng trong Học Sâu.",
                "Big Data": "<strong>Dữ liệu lớn (Big Data):</strong> Thuật ngữ mô tả các tập dữ liệu cực lớn, đa dạng và phức tạp, đòi hỏi các công cụ và kỹ thuật đặc biệt để thu thập, lưu trữ, xử lý và phân tích.",
                "LLM": "<strong>Mô hình Ngôn ngữ Lớn (Large Language Model - LLM):</strong> Loại mô hình AI được huấn luyện trên lượng lớn dữ liệu văn bản, có khả năng hiểu, tạo ra và tương tác bằng ngôn ngữ tự nhiên một cách tinh vi.",
                "Prompt": "<strong>Prompt:</strong> Câu lệnh, yêu cầu, câu hỏi hoặc bất kỳ đầu vào dạng văn bản nào mà người dùng cung cấp cho mô hình AI tạo sinh để hướng dẫn nó thực hiện một tác vụ cụ thể.",
                "Prompt Engineering": "<strong>Kỹ thuật viết prompt (Prompt Engineering):</strong> Quá trình thiết kế, tinh chỉnh và tối ưu hóa các prompt để đạt được kết quả đầu ra mong muốn, chính xác và chất lượng cao từ các mô hình AI tạo sinh.",
                "Generative AI": "<strong>AI Tạo sinh (Generative AI):</strong> Loại AI có khả năng tạo ra nội dung mới và độc đáo, bao gồm văn bản, hình ảnh, âm thanh, video, và mã nguồn, dựa trên dữ liệu mà nó đã được huấn luyện.",
                "Data": "<strong>Dữ liệu (Data):</strong> Các thông tin thô, chưa qua xử lý, được thu thập dưới nhiều dạng khác nhau (văn bản, số liệu, hình ảnh, âm thanh...). Dữ liệu là 'nhiên liệu' cho AI.",
                "GIGO": "<strong>GIGO (Garbage In, Garbage Out):</strong> Nguyên tắc cơ bản trong khoa học máy tính, đặc biệt quan trọng với AI, có nghĩa là 'rác vào thì rác ra'. Chất lượng của dữ liệu đầu vào sẽ quyết định chất lượng của kết quả đầu ra.",
                "Data Cleaning": "<strong>Làm sạch dữ liệu (Data Cleaning):</strong> Quá trình phát hiện, sửa chữa hoặc loại bỏ các lỗi, sự không nhất quán, dữ liệu thiếu hoặc không chính xác trong một tập dữ liệu để cải thiện chất lượng và độ tin cậy của nó.",
                "Data Privacy": "<strong>Quyền riêng tư dữ liệu (Data Privacy):</strong> Quyền của cá nhân trong việc kiểm soát cách thông tin cá nhân của họ được thu thập, sử dụng, lưu trữ và chia sẻ. Đây là một vấn đề đạo đức quan trọng khi ứng dụng AI, đặc biệt trong giáo dục.",
                "AI Bias": "<strong>Thiên kiến AI (AI Bias):</strong> Hiện tượng hệ thống AI đưa ra các kết quả bất công hoặc mang tính định kiến một cách có hệ thống do dữ liệu huấn luyện sai lệch hoặc thiết kế thuật toán có vấn đề.",
                "AI Ethics": "<strong>Đạo đức AI (AI Ethics):</strong> Một nhánh của đạo đức học ứng dụng, xem xét các vấn đề đạo đức và xã hội phát sinh từ việc phát triển và sử dụng trí tuệ nhân tạo.",
                "Chatbot": "<strong>Chatbot:</strong> Một chương trình máy tính được thiết kế để mô phỏng cuộc trò chuyện với người dùng, đặc biệt là qua Internet, thường sử dụng AI để hiểu và phản hồi."
            }
        };
        
        // Gán dữ liệu quiz cho các chương tương ứng (đảm bảo không bị ghi đè nếu ebookData được định nghĩa lại)
        const ch1Data = ebookData.chapters.find(c => c.id === 'chuong1');
        if (ch1Data) {
            ch1Data.quiz = {
                id: "quiz_c1",
                questions: [
                    { id: "q1c1", text: "AI là viết tắt của cụm từ nào?", options: [ { text: "Artificial Insight", value: "A" }, { text: "Automated Intelligence", value: "B" }, { text: "Artificial Intelligence", value: "C" }, { text: "Algorithmic Integration", value: "D" } ], correctAnswer: "C", explanation: "AI là viết tắt của Artificial Intelligence, nghĩa là Trí tuệ Nhân tạo." },
                    { id: "q2c1", text: "Công việc nào sau đây KHÔNG phải là một ứng dụng của AI?", options: [ { text: "Gợi ý sản phẩm trên trang mua sắm", value: "A" }, { text: "Lọc email spam", value: "B" }, { text: "Chụp ảnh bằng máy ảnh kỹ thuật số thông thường", value: "C" }, { text: "Dịch tự động văn bản", value: "D" } ], correctAnswer: "C", explanation: "Chụp ảnh bằng máy ảnh số thông thường là thao tác cơ học, trừ khi máy ảnh đó có tích hợp AI để tự động cải thiện chất lượng ảnh." }
                ]
            };
        }

        const ch2Data = ebookData.chapters.find(c => c.id === 'chuong2');
        if (ch2Data) {
            ch2Data.quiz = {
                id: "quiz_c2",
                questions: [
                    { id: "q1c2", text: "Nguyên tắc GIGO muốn nhấn mạnh điều gì?", options: [ { text: "AI cần rất nhiều dữ liệu.", value: "A" }, { text: "Chất lượng dữ liệu đầu vào quyết định chất lượng đầu ra của AI.", value: "B" }, { text: "AI có thể tự sửa lỗi dữ liệu.", value: "C" }, { text: "Mọi loại dữ liệu đều hữu ích cho AI.", value: "D" } ], correctAnswer: "B", explanation: "GIGO (Garbage In, Garbage Out) nghĩa là nếu dữ liệu đầu vào không tốt, kết quả AI tạo ra cũng sẽ không tốt." },
                    { id: "q2c2", text: "Yếu tố nào sau đây KHÔNG ảnh hưởng trực tiếp đến chất lượng NỘI DUNG của dữ liệu cho AI?", options: [ { text: "Tính đầy đủ", value: "A" }, { text: "Tính chính xác", value: "B" }, { text: "Kích thước file dữ liệu", value: "C" }, { text: "Tính nhất quán", value: "D" } ], correctAnswer: "C", explanation: "Kích thước file có thể ảnh hưởng đến việc lưu trữ và xử lý, nhưng không phải là yếu tố trực tiếp quyết định chất lượng nội dung của dữ liệu." }
                ]
            };
        }


        document.addEventListener('DOMContentLoaded', () => {
            const navigationMenu = document.getElementById('navigation-menu');
            const ebookContentArea = document.getElementById('ebook-content-area');
            const askGeminiBtn = document.getElementById('ask-gemini-btn');
            const geminiModal = document.getElementById('gemini-modal');
            const closeGeminiModalBtn = document.getElementById('close-gemini-modal');
            const submitGeminiPromptBtn = document.getElementById('submit-gemini-prompt');
            const geminiPromptInput = document.getElementById('gemini-prompt-input');
            const geminiResponseArea = document.getElementById('gemini-response-area');
            const geminiLoadingIndicator = document.getElementById('gemini-loading-indicator');

            const notesModal = document.getElementById('notes-modal');
            const closeNotesModalBtn = document.getElementById('close-notes-modal');
            const saveNoteBtn = document.getElementById('save-note');
            const cancelNoteBtn = document.getElementById('cancel-note');
            const noteInput = document.getElementById('note-input');

            const glossaryModal = document.getElementById('glossary-modal');
            const closeGlossaryModalBtn = document.getElementById('close-glossary-modal');
            const glossaryTermTitle = document.getElementById('glossary-term-title');
            const glossaryTermDefinition = document.getElementById('glossary-term-definition');
            
            const highlightColorPicker = document.getElementById('highlight-color-picker');
            const removeHighlightBtn = document.getElementById('remove-highlight-btn');

            const searchInput = document.getElementById('search-input');
            const mobileMenuToggle = document.getElementById('mobile-menu-toggle');
            const sidebar = document.getElementById('sidebar');
            const sidebarOverlay = document.getElementById('sidebar-overlay');
            const mobileChapterTitle = document.getElementById('mobile-chapter-title');
            const mainContentWrapper = document.getElementById('main-content-wrapper');
            const authorInfoSidebar = document.getElementById('author-info-sidebar');
            const mainEbookTitleDesktop = document.getElementById('main-ebook-title-desktop');


            let currentChapterId = null;
            let currentNoteContext = null; 
            let currentSelectionForHighlight = null;

            const chapterGroups = ebookData.chapters.reduce((acc, chapter) => {
                const groupName = chapter.group || "Chung";
                if (!acc[groupName]) {
                    acc[groupName] = [];
                }
                acc[groupName].push(chapter);
                return acc;
            }, {});

            const navUl = document.createElement('ul');
            navUl.className = "space-y-1";

            Object.keys(chapterGroups).forEach(groupName => {
                const groupTitleLi = document.createElement('li');
                groupTitleLi.className = 'chapter-group-title';
                groupTitleLi.textContent = groupName;
                navUl.appendChild(groupTitleLi);

                chapterGroups[groupName].forEach(chapter => {
                    const li = document.createElement('li');
                    const a = document.createElement('a');
                    a.href = `#${chapter.id}`;
                    a.textContent = chapter.title;
                    a.dataset.chapterId = chapter.id;
                    a.addEventListener('click', (e) => {
                        e.preventDefault();
                        loadChapter(chapter.id);
                        if (window.innerWidth < 768) {
                            sidebar.classList.remove('open');
                            sidebarOverlay.classList.remove('active');
                            mobileMenuToggle.innerHTML = '<i class="fas fa-bars"></i>';
                        }
                    });
                    li.appendChild(a);
                    navUl.appendChild(li);
                });
            });
            navigationMenu.appendChild(navUl);

            // Populate Author Info in Sidebar
            if (ebookData.meta.author) {
                const authorTitle = document.createElement('div');
                authorTitle.className = 'author-info-title';
                authorTitle.textContent = 'Thông Tin Tác Giả';
                authorInfoSidebar.appendChild(authorTitle);

                const authorContent = document.createElement('div');
                authorContent.className = 'author-info-content';
                authorContent.innerHTML = `
                    <p><strong>${ebookData.meta.author}</strong></p>
                    ${ebookData.meta.phone ? `<p><i class="fas fa-phone"></i> ${ebookData.meta.phone}</p>` : ''}
                    ${ebookData.meta.email ? `<p><i class="fas fa-envelope"></i> ${ebookData.meta.email}</p>` : ''}
                `;
                authorInfoSidebar.appendChild(authorContent);
            }
            
            mobileMenuToggle.addEventListener('click', () => {
                const isOpen = sidebar.classList.toggle('open');
                sidebarOverlay.classList.toggle('active', isOpen);
                if (isOpen) {
                    mobileMenuToggle.innerHTML = '<i class="fas fa-times"></i>';
                } else {
                    mobileMenuToggle.innerHTML = '<i class="fas fa-bars"></i>';
                }
            });

            sidebarOverlay.addEventListener('click', () => {
                sidebar.classList.remove('open');
                sidebarOverlay.classList.remove('active');
                mobileMenuToggle.innerHTML = '<i class="fas fa-bars"></i>';
            });


            function loadChapter(chapterId, searchTerm = null) {
                const chapter = ebookData.chapters.find(c => c.id === chapterId);
                if (!chapter) {
                    ebookContentArea.innerHTML = `<p class="text-red-500">Lỗi: Không tìm thấy chương.</p>`;
                    return;
                }

                currentChapterId = chapterId;
                let content = ``;
                
                // Update main ebook title for desktop
                if(mainEbookTitleDesktop) {
                    mainEbookTitleDesktop.textContent = ebookData.meta.title;
                }
                
                // Chapter specific title
                 if (chapter.id !== "loiMoDau" && chapter.id !== "loiKet") { 
                    content += `<h1 class="text-3xl font-bold text-navy-primary mb-2">${chapter.title}</h1>`;
                } else if (chapter.id === "loiMoDau" || chapter.id === "loiKet") { 
                     // For intro/outro, the main title is already in header, so we can have a centered specific title if needed
                     // Or just use the contentHTML directly if it already includes a suitable title.
                     // For now, let's assume contentHTML for Lời Mở Đầu and Lời Kết handles its own display.
                     // If chapter.title for Lời Mở Đầu/Kết is distinct and needs displaying, add here.
                }
                content += chapter.contentHTML;

                if (chapter.summary && chapter.summary.length > 0) {
                    content += `<div class="mt-10 pt-6 border-t-2 border-gold-accent">
                                    <h3 class="text-xl font-semibold text-navy-primary mb-3">Tóm Tắt Nội Dung Chương</h3>
                                    <ul class="list-disc pl-6 space-y-1 text-gray-700">
                                        ${chapter.summary.map(item => `<li>${item}</li>`).join('')}
                                    </ul>
                                </div>`;
                }
                ebookContentArea.innerHTML = content;
                mobileChapterTitle.textContent = chapter.title; 

                if (chapter.quiz) {
                    const quizContainerId = `quiz-${chapter.id}`; 
                    const quizContainer = ebookContentArea.querySelector(`#${quizContainerId}`);
                    if (quizContainer) {
                        renderQuiz(chapter.quiz, quizContainer);
                    }
                }
                
                setupInteractiveElements();
                loadHighlightsForChapter(chapterId);
                loadNotesForChapter(chapterId);

                if (searchTerm && searchTerm.length > 0) {
                    highlightSearchTermInContent(searchTerm);
                } else {
                    clearSearchHighlights(); 
                }

                document.querySelectorAll('#navigation-menu a').forEach(a => {
                    a.classList.toggle('active', a.dataset.chapterId === chapterId);
                });
                
                document.getElementById('main-content').scrollTop = 0;
                localStorage.setItem('lastVisitedChapter', chapterId);
            }

            function clearSearchHighlights() {
                ebookContentArea.querySelectorAll('mark.search-highlight').forEach(mark => {
                    const parent = mark.parentNode;
                    if (parent) { 
                        parent.replaceChild(document.createTextNode(mark.textContent), mark);
                        parent.normalize(); 
                    }
                });
            }
            
            function highlightSearchTermInContent(term) {
                clearSearchHighlights(); 
                if (!term || term.length < 1) return;

                const regex = new RegExp(term.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'gi');
                const treeWalker = document.createTreeWalker(ebookContentArea, NodeFilter.SHOW_TEXT, null, false);
                let node;
                const nodesToProcess = [];

                while (node = treeWalker.nextNode()) {
                    if (node.nodeValue.toLowerCase().includes(term.toLowerCase()) && 
                        node.parentNode && 
                        node.parentNode.tagName !== 'SCRIPT' && 
                        node.parentNode.tagName !== 'STYLE' &&
                        !node.parentNode.closest('textarea, input')) { 
                        nodesToProcess.push(node);
                    }
                }

                nodesToProcess.forEach(textNode => {
                    const parent = textNode.parentNode;
                    if (!parent) return; 

                    let currentText = textNode.nodeValue;
                    let match;
                    let lastIndex = 0;
                    const fragment = document.createDocumentFragment();

                    while ((match = regex.exec(currentText)) !== null) {
                        if (match.index > lastIndex) {
                            fragment.appendChild(document.createTextNode(currentText.substring(lastIndex, match.index)));
                        }
                        const mark = document.createElement('mark');
                        mark.className = 'search-highlight'; 
                        mark.textContent = match[0];
                        fragment.appendChild(mark);
                        lastIndex = regex.lastIndex;
                    }
                    if (lastIndex < currentText.length) {
                        fragment.appendChild(document.createTextNode(currentText.substring(lastIndex)));
                    }
                    
                    if (fragment.childNodes.length > 0) {
                         parent.replaceChild(fragment, textNode);
                    }
                });
            }


            function renderQuiz(quizData, container) {
                let quizHTML = '';
                quizData.questions.forEach((q, index) => {
                    quizHTML += `
                        <div class="quiz-question" id="question-${q.id}">
                            <p class="font-semibold text-lg mb-3">${index + 1}. ${q.text}</p>
                            <div class="quiz-options space-y-2">
                                ${q.options.map(opt => `
                                    <label class="flex items-center p-3 border-2 border-gray-300 rounded-md hover:border-gold-accent cursor-pointer">
                                        <input type="radio" name="q_${q.id}" value="${opt.value}" class="mr-3">
                                        <span>${opt.text}</span>
                                    </label>
                                `).join('')}
                            </div>
                            <div id="feedback-${q.id}" class="quiz-feedback mt-3 hidden"></div>
                        </div>
                    `;
                });
                quizHTML += `<button class="submit-quiz-btn mt-4" data-quiz-id="${quizData.id}">Nộp Bài</button>`;
                container.innerHTML = quizHTML;

                container.querySelector(`.submit-quiz-btn[data-quiz-id="${quizData.id}"]`).addEventListener('click', () => {
                    submitQuiz(quizData.id);
                });
            }

            function submitQuiz(quizId) {
                const chapterWithQuiz = ebookData.chapters.find(c => c.quiz && c.quiz.id === quizId);
                if (!chapterWithQuiz || !chapterWithQuiz.quiz) return;
                const quizData = chapterWithQuiz.quiz;

                let score = 0;
                quizData.questions.forEach(q => {
                    const selectedOption = document.querySelector(`input[name="q_${q.id}"]:checked`);
                    const feedbackDiv = document.getElementById(`feedback-${q.id}`);
                    if (!feedbackDiv) return;
                    feedbackDiv.classList.remove('hidden');
                    if (selectedOption) {
                        if (selectedOption.value === q.correctAnswer) {
                            score++;
                            feedbackDiv.innerHTML = `<strong class="text-green-700"><i class="fas fa-check-circle mr-1"></i>Đúng!</strong> <span class="quiz-explanation">${q.explanation || ''}</span>`;
                            feedbackDiv.className = 'quiz-feedback correct';
                        } else {
                            feedbackDiv.innerHTML = `<strong class="text-red-700"><i class="fas fa-times-circle mr-1"></i>Sai.</strong> Đáp án đúng là ${q.correctAnswer}. <span class="quiz-explanation">${q.explanation || ''}</span>`;
                            feedbackDiv.className = 'quiz-feedback incorrect';
                        }
                    } else {
                        feedbackDiv.innerHTML = `<strong class="text-yellow-700"><i class="fas fa-exclamation-circle mr-1"></i>Chưa trả lời.</strong> Đáp án đúng là ${q.correctAnswer}. <span class="quiz-explanation">${q.explanation || ''}</span>`;
                        feedbackDiv.className = 'quiz-feedback incorrect'; 
                    }
                });
            }
            
            function setupInteractiveElements() {
                ebookContentArea.querySelectorAll('.glossary-term').forEach(term => {
                    term.addEventListener('click', () => {
                        const termKey = term.dataset.term;
                        if (ebookData.glossary && ebookData.glossary[termKey]) {
                            glossaryTermTitle.textContent = termKey;
                            glossaryTermDefinition.innerHTML = ebookData.glossary[termKey];
                            glossaryModal.classList.remove('hidden');
                            glossaryModal.classList.add('flex');
                        }
                    });
                });

                const showSuggestionBtn = document.getElementById('show-suggestion-btn');
                if (showSuggestionBtn) {
                    showSuggestionBtn.addEventListener('click', () => {
                        document.getElementById('prompt-suggestion').classList.toggle('hidden');
                    });
                }
                
                const triggerGeminiBtnCh4 = document.getElementById('trigger-gemini-from-ch4');
                if(triggerGeminiBtnCh4) {
                    triggerGeminiBtnCh4.addEventListener('click', () => {
                        geminiModal.classList.remove('hidden');
                        geminiModal.classList.add('flex');
                        geminiPromptInput.focus();
                    });
                }
            }

            askGeminiBtn.addEventListener('click', () => {
                geminiModal.classList.remove('hidden');
                geminiModal.classList.add('flex');
                geminiPromptInput.focus();
            });
            closeGeminiModalBtn.addEventListener('click', () => {
                geminiModal.classList.add('hidden');
                geminiModal.classList.remove('flex');
            });

            submitGeminiPromptBtn.addEventListener('click', async () => {
                const prompt = geminiPromptInput.value.trim();
                if (!prompt) {
                    geminiResponseArea.innerHTML = `<p class="text-red-500">Vui lòng nhập câu hỏi hoặc yêu cầu.</p>`;
                    return;
                }

                geminiResponseArea.innerHTML = `<p class="text-gray-500 italic">Đang chờ phản hồi từ Gemini...</p>`;
                geminiLoadingIndicator.classList.remove('hidden');
                submitGeminiPromptBtn.disabled = true;

                try {
                    const payload = {
  contents: [{
    parts: [{
      text: prompt
    }]
  }]
};
                    // Không nên để API key trực tiếp trong code
const apiKey = process.env.GEMINI_API_KEY || "AIzaSyD1JQvbijNsRV5xr9CESIY0Iuw6YVfLP3o"; 
                    const apiUrl = `https://generativelanguage.googleapis.com/v1/models/gemini-pro:generateContent?key=${apiKey}`;
                    
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(`API Error: ${response.status} - ${errorData.error?.message || 'Unknown error'}`);
                    }
                    
                    const result = await response.json();

                    if (result.candidates && result.candidates.length > 0 &&
                        result.candidates[0].content && result.candidates[0].content.parts &&
                        result.candidates[0].content.parts.length > 0) {
                        const text = result.candidates[0].content.parts[0].text;
                        let formattedText = text.replace(/\n/g, '<br>');
                        formattedText = formattedText.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>'); 
                        formattedText = formattedText.replace(/\*(.*?)\*/g, '<em>$1</em>'); 
                        
                        geminiResponseArea.innerHTML = `<div class="prose prose-sm max-w-none">${formattedText}</div>`;
                    } else if (result.promptFeedback && result.promptFeedback.blockReason) {
                         geminiResponseArea.innerHTML = `<p class="text-red-500">Yêu cầu bị chặn: ${result.promptFeedback.blockReason}. Vui lòng thử lại với một yêu cầu khác.</p>`;
                    } else {
                        geminiResponseArea.innerHTML = `<p class="text-orange-500">Không nhận được nội dung hợp lệ từ Gemini.</p>`;
                        console.warn("Unexpected Gemini API response structure:", result);
                    }

                } catch (error) {
    console.error("Error calling Gemini API:", error);
    let errorMessage = "Đã xảy ra lỗi không xác định";
    
    if (error.message.includes("API key")) {
        errorMessage = "API key không hợp lệ hoặc hết hạn";
    } else if (error.message.includes("quota")) {
        errorMessage = "Đã vượt quá giới hạn yêu cầu API";
    } else if (error.message.includes("rate limit")) {
        errorMessage = "Quá nhiều yêu cầu trong thời gian ngắn. Vui lòng thử lại sau.";
    } else if (error.message.includes("network")) {
        errorMessage = "Lỗi kết nối mạng. Vui lòng kiểm tra kết nối internet.";
    }

    geminiResponseArea.innerHTML = `
        <div class="p-4 bg-red-50 border border-red-200 rounded-lg">
            <p class="text-red-600 font-medium mb-2">
                <i class="fas fa-exclamation-circle mr-2"></i>Lỗi
            </p>
            <p class="text-red-700">${errorMessage}</p>
        </div>`;
} finally {
    geminiLoadingIndicator.classList.add('hidden');
    submitGeminiPromptBtn.disabled = false;
}
            });

            function openNotesModal(context, existingNote = '') {
                currentNoteContext = context;
                noteInput.value = existingNote;
                notesModal.classList.remove('hidden');
                notesModal.classList.add('flex');
                noteInput.focus();
            }

            closeNotesModalBtn.addEventListener('click', () => {
                notesModal.classList.add('hidden');
                notesModal.classList.remove('flex');
            });
            cancelNoteBtn.addEventListener('click', () => {
                notesModal.classList.add('hidden');
                notesModal.classList.remove('flex');
            });

            saveNoteBtn.addEventListener('click', () => {
                const noteText = noteInput.value.trim();
                if (!currentNoteContext) return;

                const notes = JSON.parse(localStorage.getItem(`ebook_notes_${currentChapterId}`)) || {};
                
                if (noteText) {
                    notes[currentNoteContext.id] = { text: noteText, selection: currentNoteContext.selection };
                } else {
                    delete notes[currentNoteContext.id]; 
                }
                
                localStorage.setItem(`ebook_notes_${currentChapterId}`, JSON.stringify(notes));
                notesModal.classList.add('hidden');
                notesModal.classList.remove('flex');
                loadNotesForChapter(currentChapterId); 
            });
            
            function getPathTo(element) {
                if (!element || !element.parentNode) return ''; 
                if (element.id !== '') return `id("${element.id}")`;
                if (element === document.body) return element.tagName.toLowerCase();

                var ix = 0;
                var siblings = element.parentNode.childNodes;
                for (var i = 0; i < siblings.length; i++) {
                    var sibling = siblings[i];
                    if (sibling === element) return getPathTo(element.parentNode) + '/' + element.tagName.toLowerCase() + '[' + (ix + 1) + ']';
                    if (sibling.nodeType === 1 && sibling.tagName === element.tagName) ix++;
                }
                return ''; 
            }

            function getElementByXPath(path) {
                if (!path) return null;
                try {
                    return document.evaluate(path, document, null, XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue;
                } catch (e) {
                    console.error("Error evaluating XPath:", path, e);
                    return null;
                }
            }


            function loadNotesForChapter(chapterId) {
                ebookContentArea.querySelectorAll('.note-indicator').forEach(ind => ind.remove());

                const notes = JSON.parse(localStorage.getItem(`ebook_notes_${chapterId}`)) || {};
                Object.keys(notes).forEach(noteId => {
                    const noteData = notes[noteId];
                    let targetElementForIndicator = null;

                    if (noteData.selection && noteData.selection.type === 'highlight' && noteData.selection.highlightId) {
                        targetElementForIndicator = ebookContentArea.querySelector(`.highlighted-text[data-highlight-id='${noteData.selection.highlightId}']`);
                    } else if (noteData.selection && noteData.selection.startContainerXPath) { 
                        let startNode = getElementByXPath(noteData.selection.startContainerXPath);
                        if (startNode) {
                            targetElementForIndicator = (startNode.nodeType === Node.TEXT_NODE) ? startNode.parentNode : startNode;
                        }
                    }
                    
                    if (targetElementForIndicator) {
                        let indicator = targetElementForIndicator.querySelector(`.note-indicator[data-note-id="${noteId}"]`);
                        if(!indicator && targetElementForIndicator.classList.contains('highlighted-text')) { 
                             indicator = document.createElement('span');
                             indicator.className = 'note-indicator';
                             indicator.dataset.noteId = noteId;
                             indicator.title = "Xem ghi chú";
                             indicator.textContent = "N";
                             targetElementForIndicator.appendChild(indicator); 
                        } else if (!indicator) { 
                            indicator = document.createElement('span');
                            indicator.className = 'note-indicator';
                            indicator.dataset.noteId = noteId;
                            indicator.title = "Xem ghi chú";
                            indicator.textContent = "N";
                            
                            if (targetElementForIndicator.lastChild && targetElementForIndicator.lastChild.nodeType === Node.TEXT_NODE) {
                                targetElementForIndicator.appendChild(indicator);
                            } else if (targetElementForIndicator.lastChild) {
                                targetElementForIndicator.insertBefore(indicator, targetElementForIndicator.lastChild.nextSibling);
                            } else {
                                targetElementForIndicator.appendChild(indicator);
                            }
                        }
                         if (indicator) {
                            indicator.onclick = (e) => {
                                e.stopPropagation();
                                openNotesModal({ id: noteId, selection: noteData.selection }, noteData.text);
                            };
                        }
                    }
                });
            }


            closeGlossaryModalBtn.addEventListener('click', () => {
                glossaryModal.classList.add('hidden');
                glossaryModal.classList.remove('flex');
            });
            
            ebookContentArea.addEventListener('mouseup', (e) => {
                const selection = window.getSelection();
                if (selection.rangeCount > 0 && !selection.isCollapsed) {
                    const range = selection.getRangeAt(0);
                    if (!ebookContentArea.contains(range.commonAncestorContainer) || 
                        range.commonAncestorContainer.closest('.modal-content-scrollable, textarea, input, .quiz-options, .action-button')) {
                        hideHighlightColorPicker();
                        return;
                    }
                    
                    currentSelectionForHighlight = range.cloneRange();
                    positionHighlightColorPicker(e.clientX, e.clientY);
                } else {
                    if (!highlightColorPicker.contains(e.target)) {
                         hideHighlightColorPicker();
                    }
                }
            });

            function positionHighlightColorPicker(x, y) {
                const mainContentRect = mainContentWrapper.getBoundingClientRect();
                highlightColorPicker.style.left = `${x - mainContentRect.left}px`;
                highlightColorPicker.style.top = `${y - mainContentRect.top + mainContentWrapper.scrollTop}px`;
                highlightColorPicker.style.display = 'block';
            }
            function hideHighlightColorPicker() {
                highlightColorPicker.style.display = 'none';
                currentSelectionForHighlight = null;
            }

            highlightColorPicker.querySelectorAll('button[data-color]').forEach(button => {
                button.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const color = button.dataset.color;
                    if (currentSelectionForHighlight) {
                        applyHighlight(currentSelectionForHighlight, color);
                        saveHighlight(currentSelectionForHighlight, color);
                    }
                    hideHighlightColorPicker();
                });
            });
            
            removeHighlightBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                if (currentSelectionForHighlight) {
                    removeHighlight(currentSelectionForHighlight);
                }
                hideHighlightColorPicker();
            });

            function applyHighlight(range, color) {
                if (range.collapsed) return;
                try {
                    const commonAncestor = range.commonAncestorContainer;
                    if (commonAncestor.nodeType !== Node.ELEMENT_NODE) {
                        if (commonAncestor.parentNode && commonAncestor.parentNode.nodeType === Node.ELEMENT_NODE) {
                            commonAncestor.parentNode.querySelectorAll('span.highlighted-text').forEach(span => {
                                if (range.intersectsNode(span)) {
                                    unwrapHighlight(span);
                                }
                            });
                        }
                    } else {
                         commonAncestor.querySelectorAll('span.highlighted-text').forEach(span => {
                            if (range.intersectsNode(span)) {
                                unwrapHighlight(span);
                            }
                        });
                    }

                    const span = document.createElement('span');
                    span.className = 'highlighted-text';
                    span.style.backgroundColor = color;
                    span.dataset.highlightColor = color; 
                    const highlightId = `highlight_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
                    span.dataset.highlightId = highlightId;
                    
                    span.addEventListener('click', (e) => {
                        e.stopPropagation(); 
                        const notes = JSON.parse(localStorage.getItem(`ebook_notes_${currentChapterId}`)) || {};
                        const existingNote = notes[highlightId] ? notes[highlightId].text : '';
                        openNotesModal({ id: highlightId, selection: { type: 'highlight', highlightId: highlightId } }, existingNote);
                    });

                    range.surroundContents(span);
                    window.getSelection().removeAllRanges();
                } catch (ex) {
                    console.warn("Could not directly surround contents, attempting iterative highlighting. Error: ", ex);
                    iterativeApplyHighlight(range, color);
                }
            }
            
            function iterativeApplyHighlight(range, color) {
                const textNodes = getTextNodesInRange(range);
                textNodes.forEach(node => {
                    const span = document.createElement('span');
                    span.className = 'highlighted-text';
                    span.style.backgroundColor = color;
                    span.dataset.highlightColor = color;
                    const highlightId = `highlight_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
                    span.dataset.highlightId = highlightId;
                    
                    const nodeRange = document.createRange();
                    nodeRange.selectNodeContents(node);

                    const highlightRange = range.cloneRange();
                    highlightRange.selectNodeContents(node); 
                    
                    const startOffset = (range.startContainer === node) ? range.startOffset : 0;
                    const endOffset = (range.endContainer === node) ? range.endOffset : node.length;
                    
                    highlightRange.setStart(node, startOffset);
                    highlightRange.setEnd(node, endOffset);

                    if (!highlightRange.collapsed) {
                        try {
                            const clonedSpan = span.cloneNode(true);
                             clonedSpan.addEventListener('click', (e) => {
                                e.stopPropagation();
                                const notes = JSON.parse(localStorage.getItem(`ebook_notes_${currentChapterId}`)) || {};
                                const existingNote = notes[clonedSpan.dataset.highlightId] ? notes[clonedSpan.dataset.highlightId].text : '';
                                openNotesModal({ id: clonedSpan.dataset.highlightId, selection: { type: 'highlight', highlightId: clonedSpan.dataset.highlightId } }, existingNote);
                            });
                            highlightRange.surroundContents(clonedSpan);
                        } catch (e) {
                            console.error("Error in iterative highlighting for node: ", node, e);
                        }
                    }
                });
                window.getSelection().removeAllRanges();
            }


            function getTextNodesInRange(range) {
                const textNodes = [];
                const treeWalker = document.createTreeWalker(
                    range.commonAncestorContainer,
                    NodeFilter.SHOW_TEXT,
                    (node) => {
                        const nodeRange = document.createRange();
                        nodeRange.selectNodeContents(node);
                        return range.intersectsNode(node) ? NodeFilter.FILTER_ACCEPT : NodeFilter.FILTER_REJECT;
                    }
                );
                while (treeWalker.nextNode()) textNodes.push(treeWalker.currentNode);
                return textNodes;
            }


            function unwrapHighlight(span) {
                const parent = span.parentNode;
                if (!parent) return;
                while (span.firstChild) {
                    parent.insertBefore(span.firstChild, span);
                }
                parent.removeChild(span);
                parent.normalize(); 
            }

            function removeHighlight(range) {
                const commonAncestor = range.commonAncestorContainer;
                const spansToRemove = [];

                if (!commonAncestor) return;

                let parentElement = commonAncestor;
                if (commonAncestor.nodeType !== Node.ELEMENT_NODE) {
                    parentElement = commonAncestor.parentNode;
                }
                
                if (parentElement && parentElement.querySelectorAll) {
                    parentElement.querySelectorAll('span.highlighted-text').forEach(span => {
                        if (range.intersectsNode(span)) spansToRemove.push(span);
                    });
                }
                
                spansToRemove.forEach(span => {
                    const highlightId = span.dataset.highlightId;
                    if (highlightId) {
                        const notes = JSON.parse(localStorage.getItem(`ebook_notes_${currentChapterId}`)) || {};
                        delete notes[highlightId];
                        localStorage.setItem(`ebook_notes_${currentChapterId}`, JSON.stringify(notes));
                    }
                    unwrapHighlight(span);
                });
                removeHighlightFromStorage(range);
                window.getSelection().removeAllRanges();
            }


            function serializeRange(range) {
                if (!range || !range.startContainer || !range.endContainer || !range.commonAncestorContainer) return null;
                return {
                    startContainerXPath: getPathTo(range.startContainer),
                    startOffset: range.startOffset,
                    endContainerXPath: getPathTo(range.endContainer),
                    endOffset: range.endOffset,
                    commonAncestorXPath: getPathTo(range.commonAncestorContainer)
                };
            }

            function deserializeRange(serializedRange) {
                if (!serializedRange) return null;
                const range = document.createRange();
                try {
                    const startContainer = getElementByXPath(serializedRange.startContainerXPath);
                    const endContainer = getElementByXPath(serializedRange.endContainerXPath);
                    if (!startContainer || !endContainer) {
                        console.warn("Could not find start or end container for deserializing range.");
                        return null;
                    }
                    range.setStart(startContainer, serializedRange.startOffset);
                    range.setEnd(endContainer, serializedRange.endOffset);
                    return range;
                } catch (e) {
                    console.error("Error deserializing range:", e, serializedRange);
                    return null;
                }
            }

            function saveHighlight(range, color) {
                if (!currentChapterId) return;
                const serialized = serializeRange(range);
                if (!serialized) return; 

                const highlights = JSON.parse(localStorage.getItem(`ebook_highlights_${currentChapterId}`)) || [];
                highlights.push({ range: serialized, color: color });
                localStorage.setItem(`ebook_highlights_${currentChapterId}`, JSON.stringify(highlights));
            }
            
            function removeHighlightFromStorage(rangeToRemove) {
                 if (!currentChapterId) return;
                let highlights = JSON.parse(localStorage.getItem(`ebook_highlights_${currentChapterId}`)) || [];
                const serializedToRemove = serializeRange(rangeToRemove);
                if (!serializedToRemove) return;

                highlights = highlights.filter(h => {
                    return !(h.range.commonAncestorXPath === serializedToRemove.commonAncestorXPath &&
                             Math.abs(h.range.startOffset - serializedToRemove.startOffset) < 5 && 
                             Math.abs(h.range.endOffset - serializedToRemove.endOffset) < 5);
                });
                localStorage.setItem(`ebook_highlights_${currentChapterId}`, JSON.stringify(highlights));
            }


            function loadHighlightsForChapter(chapterId) {
                ebookContentArea.querySelectorAll('span.highlighted-text').forEach(span => unwrapHighlight(span));

                const highlights = JSON.parse(localStorage.getItem(`ebook_highlights_${chapterId}`)) || [];
                highlights.forEach(h => {
                    const range = deserializeRange(h.range);
                    if (range) {
                        applyHighlight(range, h.color);
                    }
                });
            }
            // Thêm hàm này sau phần loadHighlightsForChapter và loadNotesForChapter

function loadHighlightsAndNotes() {
    // Batch DOM updates để tránh reflow/repaint liên tục
    requestAnimationFrame(() => {
        // Cache DOM queries
        const highlights = JSON.parse(localStorage.getItem(`ebook_highlights_${currentChapterId}`)) || [];
        const notes = JSON.parse(localStorage.getItem(`ebook_notes_${currentChapterId}`)) || {};
        
        // Tạo DocumentFragment để batch các thay đổi DOM
        const fragment = document.createDocumentFragment();
        
        // Xóa highlights/notes cũ trong một lần thao tác
        const existingHighlights = ebookContentArea.querySelectorAll('.highlighted-text');
        existingHighlights.forEach(h => h.remove());
        
        const existingNotes = ebookContentArea.querySelectorAll('.note-indicator');
        existingNotes.forEach(n => n.remove());
        
        // Áp dụng highlights mới
        highlights.forEach(h => {
            const range = deserializeRange(h.range);
            if (range) {
                applyHighlight(range, h.color);
            }
        });
        
        // Áp dụng notes mới
        Object.keys(notes).forEach(noteId => {
            const noteData = notes[noteId];
            // ... existing note application logic
        });

        // Áp dụng tất cả thay đổi trong một lần
        ebookContentArea.appendChild(fragment);
    });
}

// Sau đó gọi hàm này trong loadChapter:
function loadChapter(chapterId, searchTerm = null) {
    // ...existing code...
    
    // Thay thế 2 lời gọi riêng lẻ bằng một lời gọi tối ưu
    // loadHighlightsForChapter(chapterId);
    // loadNotesForChapter(chapterId);
    loadHighlightsAndNotes();
    
    // ...rest of the code...
}
            ebookContentArea.addEventListener('dblclick', function(event) {
                if (event.target.closest('.highlighted-text, .glossary-term, button, a, input, textarea, .quiz-options')) {
                    return;
                }

                const selection = window.getSelection();
                if (selection.rangeCount > 0 && !selection.isCollapsed) {
                    const range = selection.getRangeAt(0);
                    const selectedText = range.toString().trim();
                    
                    if (selectedText.length > 0 && selectedText.length < 300) { 
                        const noteId = `note_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
                        const serializedSel = serializeRange(range);
                        if (serializedSel) { 
                           openNotesModal({ id: noteId, selection: serializedSel });
                        }
                    }
                }
            });

            // Search Functionality
            searchInput.addEventListener('input', (e) => {
                const searchTerm = e.target.value.trim();
                if (currentChapterId) {
                 // Thêm hàm này trước hàm loadChapter

function showLoadingState() {
    ebookContentArea.innerHTML = `
        <div class="loading-state flex items-center justify-center p-8">
            <i class="fas fa-spinner fa-spin fa-2x text-gold-accent"></i>
            <span class="ml-3">Đang tải nội dung...</span>
        </div>
    `;
}
function getAdjacentChapters(currentChapterId) {
    const chapters = ebookData.chapters;
    const currentIndex = chapters.findIndex(c => c.id === currentChapterId);
    return {
        prev: currentIndex > 0 ? chapters[currentIndex - 1] : null,
        next: currentIndex < chapters.length - 1 ? chapters[currentIndex + 1] : null
    };
}
function loadChapter(chapterId, searchTerm = null) {
    // Thêm loading state khi bắt đầu tải
    showLoadingState();
    
    try {
        const chapter = ebookData.chapters.find(c => c.id === chapterId);
        if (!chapter) {
            ebookContentArea.innerHTML = `<p class="text-red-500">Lỗi: Không tìm thấy chương.</p>`;
            return;
        }
        // ...existing code...
    } catch(error) {
        console.error("Error loading chapter:", error);
        ebookContentArea.innerHTML = `
            <div class="error-state p-4 bg-red-50 rounded-lg">
                <h3 class="text-red-600">Lỗi tải nội dung</h3>
                <p>Đã xảy ra lỗi khi tải chương. Vui lòng thử lại.</p>
            </div>
        `;
    }
}   
function loadChapter(chapterId, searchTerm = null) {
    // ...existing code...
    
    let content = `${chapter.contentHTML}`;
                    loadChapter(currentChapterId, searchTerm); 
                }
            });


            const lastChapter = localStorage.getItem('lastVisitedChapter');
            if (lastChapter && ebookData.chapters.find(c => c.id === lastChapter)) {
                loadChapter(lastChapter);
            } else if (ebookData.chapters.length > 0) {
                loadChapter(ebookData.chapters[0].id); 
            }
            // Ensure main title is rendered if no chapter is loaded initially (e.g., on fresh load without lastChapter)
             if (!currentChapterId && mainEbookTitleDesktop) { // Check if mainEbookTitleDesktop exists
                mainEbookTitleDesktop.textContent = ebookData.meta.title;
            }
const { prev, next } = getAdjacentChapters(chapterId);
    content += `
        <div class="navigation-buttons fixed bottom-4 left-0 right-0 flex justify-center space-x-4 p-4 md:static md:mt-8 bg-white bg-opacity-90 shadow-lg z-40">
            ${prev ? `
                <button onclick="loadChapter('${prev.id}')" 
                    class="flex items-center px-4 py-2 bg-navy-primary text-white rounded-lg hover:bg-opacity-90">
                    <i class="fas fa-arrow-left mr-2"></i>
                    <span class="hidden sm:inline">${prev.title}</span>
                    <span class="sm:hidden">Trước</span>
                </button>
            ` : ''}
            
            ${next ? `
                <button onclick="loadChapter('${next.id}')" 
                    class="flex items-center px-4 py-2 bg-navy-primary text-white rounded-lg hover:bg-opacity-90">
                    <span class="hidden sm:inline">${next.title}</span>
                    <span class="sm:hidden">Tiếp</span>
                    <i class="fas fa-arrow-right ml-2"></i>
                </button>
            ` : ''}
        </div>
    `;

    ebookContentArea.innerHTML = content;
    
    // ...rest of existing code...
}

        });
    </script>
</body>
</html>
